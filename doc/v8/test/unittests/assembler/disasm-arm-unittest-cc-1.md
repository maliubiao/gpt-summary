Response:
My thought process to answer the request goes like this:

1. **Understand the Core Request:** The user wants to understand the functionality of the provided C++ code snippet, which is part of a V8 unit test file for ARM disassembler. Key aspects to identify are: file purpose, potential Torque connection, relevance to JavaScript, code logic, common programming errors, and a final summary. The "part 2 of 3" indicates a larger context, but the current snippet should be self-contained for analysis.

2. **Initial Analysis of the Code Snippet:** I immediately recognize that this code is testing the *disassembler* for ARM instructions. It uses a `COMPARE` macro, which strongly suggests a testing framework where the output of the disassembler for a given instruction encoding is compared against an expected string representation. The instructions themselves are related to floating-point (VFP) and NEON (SIMD) operations in ARM architecture. Keywords like `vstr`, `vldm`, `vmla`, `vcvt`, `vrint`, `vmaxnm`, `vminnm`, `vsel`, `vld1`, `vst1`, `vmovl`, `vqmovn`, `vmov`, `vmvn`, `vswp`, `vdup`, `vclt`, `vabs`, `vneg`, `veor`, `vand`, `vbic`, `vorr`, `vmin`, `vmax`, `vpadd`, `vpadal`, `vpaddl`, `vpmax`, `vadd`, `vqadd`, `vsub`, `vqsub`, `vmul`, `vqrdmulh`, `vmull`, `vmlal`, `vshl`, `vshr`, `vsli`, `vsri`, `vrecpe`, `vrecps`, `vrsqrte`, `vrsqrts`, `vtst`, `vceq`, `vcge`, `vcgt`, `vrhadd`, `vbsl`, `vext`, `vzip`, `vuzp`, `vrev`, `vtrn`, `vtbl`, `vtbx`, `vcnt`, `ldrb`, `strb`, `ldrh`, `strh`, `ldr`, `str`, `ldrd`, `strd`, `pld` are all ARM or NEON assembly instructions.

3. **Address Specific Questions:**

    * **Functionality:** The primary function is to test the ARM disassembler. It takes encoded ARM instructions and verifies that the disassembler produces the correct human-readable assembly representation. This involves testing various ARM and NEON instructions, including data transfers, arithmetic, logical, and floating-point operations.

    * **Torque:**  The code ends in `.cc`, indicating it's C++. The prompt asks about `.tq` (Torque). Based on the file extension, this is *not* a Torque file. I need to explicitly state this.

    * **JavaScript Relation:**  While this specific file deals with low-level ARM assembly, it's part of the V8 JavaScript engine. V8 compiles JavaScript to machine code, and this disassembler is used for debugging, code inspection, and potentially for optimization analysis within the V8 context. A simple JavaScript example demonstrating how these low-level operations *might* be related (though indirectly) is needed. Floating-point and array manipulations are good candidates.

    * **Code Logic/Input-Output:** The core logic is the `COMPARE` macro. I need to explain that it takes an assembler instruction constructor (e.g., `vstr(d16, r0, 0)`) and the *expected* disassembled string. The "input" is the binary encoding generated by the assembler instruction, and the "output" is the disassembled string. I can provide a concrete example using one of the `COMPARE` calls.

    * **Common Programming Errors:** This is a bit tricky because the code *itself* is a test, not code that users directly write. However, I can infer common errors by thinking about what the *disassembler* is trying to get right: incorrect opcode encoding, wrong operand order, missing or incorrect modifiers (like `.f64`, `.s32`), and incorrect immediate values. I should provide examples related to these.

    * **Summary of Functionality (Part 2):** This requires synthesizing the observations from the initial analysis and the specific questions. I need to reiterate that this section continues testing the disassembler, focusing on VFP, NEON, and load/store instructions, building upon the likely functionality of "part 1."

4. **Structure the Answer:**  I will organize the answer according to the questions in the prompt, making it easy for the user to follow. I'll use clear headings and code formatting to enhance readability.

5. **Refine and Review:** Before submitting, I'll re-read my answer to ensure it's accurate, complete, and addresses all parts of the prompt. I'll double-check for any inconsistencies or areas that might be unclear. For instance, I'll make sure the JavaScript example is simple and relevant. I'll confirm the assumptions about "part 1" and "part 3" are reasonable given the context.

By following these steps, I can systematically analyze the provided code snippet and generate a comprehensive and informative answer that addresses all aspects of the user's request.
好的，让我们来分析一下 `v8/test/unittests/assembler/disasm-arm-unittest.cc` 代码片段的功能。

**功能列举:**

这个 C++ 代码片段是 V8 JavaScript 引擎的一部分，专门用于测试 ARM 架构的**反汇编器 (disassembler)** 的功能。  其主要目的是：

1. **生成 ARM 汇编指令的机器码：** 代码中使用了 V8 的汇编器 (`assm`) 来生成各种 ARM 和 NEON (Advanced SIMD) 汇编指令的二进制表示（机器码）。例如，`vstr d16, [r0 + 4*0]` 这样的汇编指令会被转换成对应的机器码。

2. **使用反汇编器反汇编机器码：**  虽然代码中没有显式地调用反汇编器，但 `COMPARE` 宏的内部机制会获取生成的机器码，并使用 V8 的反汇编器将其转换回汇编代码的字符串表示。

3. **比较反汇编结果与预期结果：**  `COMPARE` 宏是核心，它将反汇编器生成的汇编字符串与预期的字符串进行比较。如果两者一致，则测试通过，否则测试失败。  例如，`COMPARE(vstr(d16, r0, 0), "edc00b00       vstr d16, [r0 + 4*0]");`  会检查 `vstr(d16, r0, 0)` 生成的机器码反汇编后是否为 `"edc00b00       vstr d16, [r0 + 4*0]"。

4. **覆盖各种 ARM 和 NEON 指令：**  代码片段中包含了大量的 `COMPARE` 调用，覆盖了 ARMv7、ARMv8 以及 NEON 指令集中的各种指令，例如：
    * **数据传输指令:** `vstr`, `vldm`, `vld1`, `vst1`, `ldr`, `str`, `ldrd`, `strd`
    * **浮点运算指令:** `vmla`, `vcvt`, `vrinta`, `vrintp`, `vrintn`, `vrintm`, `vrintz`, `vmaxnm`, `vminnm`, `vsel`
    * **SIMD 运算指令:** `vmovl`, `vqmovn`, `vmov`, `vmvn`, `vswp`, `vdup`, `vclt`, `vabs`, `vneg`, `veor`, `vand`, `vbic`, `vorr`, `vmin`, `vmax`, `vpadd`, `vpadal`, `vpaddl`, `vpmax`, `vadd`, `vqadd`, `vsub`, `vqsub`, `vmul`, `vqrdmulh`, `vmull`, `vmlal`, `vshl`, `vshr`, `vsli`, `vsri`, `vrecpe`, `vrecps`, `vrsqrte`, `vrsqrts`, `vtst`, `vceq`, `vcge`, `vcgt`, `vrhadd`, `vbsl`, `vext`, `vzip`, `vuzp`, `vrev`, `vtrn`, `vtbl`, `vtbx`, `vcnt`
    * **普通寄存器操作指令:**  `ldrb`, `strb`, `ldrh`, `strh`
    * **预加载指令:** `pld`

**关于文件类型和 JavaScript 关联:**

* **`.tq` 文件：**  `v8/test/unittests/assembler/disasm-arm-unittest.cc` 的确是以 `.cc` 结尾，这意味着它是一个 **C++ 源代码文件**。如果它以 `.tq` 结尾，那它才是一个 **V8 Torque 源代码文件**。 Torque 是一种用于定义 V8 内部运行时函数的领域特定语言。

* **与 JavaScript 的关系：**  虽然这个文件本身是 C++ 代码，用于测试汇编器的正确性，但它与 JavaScript 的功能有密切关系。  V8 引擎负责执行 JavaScript 代码，并将 JavaScript 代码编译成机器码，然后在目标架构（例如 ARM）上执行。  这个反汇编器在 V8 的开发和调试过程中扮演着重要的角色，它可以：
    * **帮助开发者理解 V8 生成的机器码。**
    * **用于调试和验证代码生成器的正确性。**
    * **在某些情况下，可能用于性能分析和优化。**

**JavaScript 举例说明：**

虽然不能直接用 JavaScript 代码来演示这个 C++ 单元测试的功能，但可以展示一些 JavaScript 代码，V8 在执行这些代码时可能会生成类似的 ARM 汇编指令。

```javascript
function addArrays(arr1, arr2) {
  const result = [];
  for (let i = 0; i < arr1.length; i++) {
    result.push(arr1[i] + arr2[i]);
  }
  return result;
}

const a = [1.5, 2.5, 3.5, 4.5];
const b = [0.5, 1.5, 2.5, 3.5];
const sum = addArrays(a, b);
console.log(sum); // 输出 [2, 4, 6, 8]
```

在 V8 执行 `addArrays` 函数时，特别是当数组较大时，V8 的优化编译器 (TurboFan) 可能会使用 NEON 指令来并行执行数组元素的加法操作，这可能会涉及到类似 `vadd.f32 q0, q1, q2` 这样的 NEON 指令。  `v8/test/unittests/assembler/disasm-arm-unittest.cc` 中的测试就是为了确保 V8 能够正确地反汇编这些生成的 NEON 指令。

**代码逻辑推理 (假设输入与输出):**

假设我们执行以下 `COMPARE` 调用：

```c++
COMPARE(vadd(Neon8, q0, q1, q2), "f2020844       vadd.i8 q0, q1, q2");
```

* **假设输入 (V8 汇编器生成):**  V8 的汇编器在执行 `vadd(Neon8, q0, q1, q2)` 时，会生成对应的 ARM 机器码。 这个机器码很可能就是 `0xf2020844` (以十六进制表示)。

* **输出 (V8 反汇编器):**  V8 的反汇编器接收到机器码 `0xf2020844` 后，会将其解码并生成汇编代码字符串 `"f2020844       vadd.i8 q0, q1, q2"`。

* **`COMPARE` 宏的比较:** `COMPARE` 宏会比较反汇编器的输出 `"f2020844       vadd.i8 q0, q1, q2"` 和预期的字符串 `"f2020844       vadd.i8 q0, q1, q2"`。  如果两者相同，则该测试用例通过。

**涉及用户常见的编程错误 (反汇编角度):**

从反汇编的角度来看，用户常见的编程错误通常体现在生成的机器码与预期的汇编指令不符。例如：

1. **操作码错误:**  如果代码生成器错误地使用了错误的指令编码，反汇编器可能会产生完全不同的指令。 例如，本应生成 `vadd` 的机器码，却生成了 `vsub` 的机器码。

2. **寄存器错误:**  错误地指定了源或目标寄存器。例如，本应操作 `q0` 寄存器，却操作了 `q1` 寄存器。  反汇编器会正确地显示错误的寄存器。

3. **立即数错误:**  对于带有立即数的指令，如果立即数编码错误，反汇编器会显示错误的立即数值。

4. **寻址模式错误:**  对于内存访问指令，如果寻址模式（例如，偏移量、预/后索引）编码错误，反汇编器会显示错误的寻址方式。

**第 2 部分功能归纳:**

这个代码片段（`v8/test/unittests/assembler/disasm-arm-unittest.cc` 的一部分）的主要功能是**测试 V8 JavaScript 引擎中 ARM 反汇编器的正确性**。 它通过以下步骤实现：

1. 使用 V8 的汇编器生成各种 ARM 和 NEON 指令的机器码。
2. 隐式地调用 V8 的反汇编器来反汇编这些机器码。
3. 使用 `COMPARE` 宏将反汇编结果与预期的汇编代码字符串进行比较，验证反汇编器的输出是否正确。

这段代码覆盖了大量的 ARM 和 NEON 指令，确保 V8 能够正确地反汇编其自身生成的机器码，这对于理解、调试和优化 V8 引擎至关重要。

Prompt: 
```
这是目录为v8/test/unittests/assembler/disasm-arm-unittest.cc的一个v8源代码， 请列举一下它的功能, 
如果v8/test/unittests/assembler/disasm-arm-unittest.cc以.tq结尾，那它是个v8 torque源代码，
如果它与javascript的功能有关系，请用javascript举例说明,
如果有代码逻辑推理，请给出假设输入与输出，
如果涉及用户常见的编程错误，请举例说明
这是第2部分，共3部分，请归纳一下它的功能

"""
      vstr d16, [r0 + 4*0]");
      COMPARE(vstr(d17, r1, 4),
              "edc11b01       vstr d17, [r1 + 4*1]");
      COMPARE(vstr(d31, r10, 1020),
              "edcafbff       vstr d31, [r10 + 4*255]");

      COMPARE(vstm(ia, r0, d16, d31),
              "ecc00b20       vstmia r0, {d16-d31}");
      COMPARE(vldm(ia, r3, d16, d31),
              "ecd30b20       vldmia r3, {d16-d31}");
      COMPARE(vstm(ia, r0, d23, d27),
              "ecc07b0a       vstmia r0, {d23-d27}");
      COMPARE(vldm(ia, r3, d23, d27),
              "ecd37b0a       vldmia r3, {d23-d27}");

      COMPARE(vmla(d16, d17, d18),
              "ee410ba2       vmla.f64 d16, d17, d18");

      COMPARE(vcvt_f32_f64(s0, d31),
              "eeb70bef       vcvt.f32.f64 s0, d31");
      COMPARE(vcvt_f32_s32(s1, s2),
              "eef80ac1       vcvt.f32.s32 s1, s2");
      COMPARE(vcvt_f64_f32(d30, s3),
              "eef7eae1       vcvt.f64.f32 d30, s3");
      COMPARE(vcvt_f64_s32(d29, s4),
              "eef8dbc2       vcvt.f64.s32 d29, s4");
      COMPARE(vcvt_f64_u32(d28, s5),
              "eef8cb62       vcvt.f64.u32 d28, s5");
      COMPARE(vcvt_s32_f32(s6, s7),
              "eebd3ae3       vcvt.s32.f32 s6, s7");
      COMPARE(vcvt_s32_f64(s8, d27),
              "eebd4beb       vcvt.s32.f64 s8, d27");
      COMPARE(vcvt_u32_f32(s9, s10),
              "eefc4ac5       vcvt.u32.f32 s9, s10");
      COMPARE(vcvt_u32_f64(s11, d26),
              "eefc5bea       vcvt.u32.f64 s11, d26");

      COMPARE(vcvt_f64_s32(d25, 2),
              "eefa9bcf       vcvt.f64.s32 d25, d25, #2");
    }
  }

  VERIFY_RUN();
}


TEST_F(DisasmArmTest, ARMv8_vrintX_disasm) {
  SET_UP();

  if (CpuFeatures::IsSupported(ARMv8)) {
    CpuFeatureScope scope(&assm, ARMv8);
    COMPARE(vrinta(d0, d0), "feb80b40       vrinta.f64.f64 d0, d0");
    COMPARE(vrinta(d2, d3), "feb82b43       vrinta.f64.f64 d2, d3");

    COMPARE(vrintp(d0, d0), "feba0b40       vrintp.f64.f64 d0, d0");
    COMPARE(vrintp(d2, d3), "feba2b43       vrintp.f64.f64 d2, d3");

    COMPARE(vrintn(d0, d0), "feb90b40       vrintn.f64.f64 d0, d0");
    COMPARE(vrintn(d2, d3), "feb92b43       vrintn.f64.f64 d2, d3");

    COMPARE(vrintm(d0, d0), "febb0b40       vrintm.f64.f64 d0, d0");
    COMPARE(vrintm(d2, d3), "febb2b43       vrintm.f64.f64 d2, d3");

    COMPARE(vrintz(d0, d0), "eeb60bc0       vrintz.f64.f64 d0, d0");
    COMPARE(vrintz(d2, d3, ne), "1eb62bc3       vrintzne.f64.f64 d2, d3");

    // Advanced SIMD
    COMPARE(vrintm(NeonS32, q0, q3), "f3ba06c6       vrintm.f32 q0, q3");
    COMPARE(vrintn(NeonS32, q0, q3), "f3ba0446       vrintn.f32 q0, q3");
    COMPARE(vrintp(NeonS32, q0, q3), "f3ba07c6       vrintp.f32 q0, q3");
    COMPARE(vrintz(NeonS32, q0, q3), "f3ba05c6       vrintz.f32 q0, q3");
  }

  VERIFY_RUN();
}


TEST_F(DisasmArmTest, ARMv8_vminmax_disasm) {
  SET_UP();

  if (CpuFeatures::IsSupported(ARMv8)) {
    CpuFeatureScope scope(&assm, ARMv8);
    COMPARE(vmaxnm(d0, d1, d2), "fe810b02       vmaxnm.f64 d0, d1, d2");
    COMPARE(vminnm(d3, d4, d5), "fe843b45       vminnm.f64 d3, d4, d5");
    COMPARE(vmaxnm(s6, s7, s8), "fe833a84       vmaxnm.f32 s6, s7, s8");
    COMPARE(vminnm(s9, s10, s11), "fec54a65       vminnm.f32 s9, s10, s11");
  }

  VERIFY_RUN();
}


TEST_F(DisasmArmTest, ARMv8_vselX_disasm) {
  SET_UP();

  if (CpuFeatures::IsSupported(ARMv8)) {
    CpuFeatureScope scope(&assm, ARMv8);
    // Native instructions.
    COMPARE(vsel(eq, d0, d1, d2),
            "fe010b02       vseleq.f64 d0, d1, d2");
    COMPARE(vsel(eq, s0, s1, s2),
            "fe000a81       vseleq.f32 s0, s1, s2");
    COMPARE(vsel(ge, d0, d1, d2),
            "fe210b02       vselge.f64 d0, d1, d2");
    COMPARE(vsel(ge, s0, s1, s2),
            "fe200a81       vselge.f32 s0, s1, s2");
    COMPARE(vsel(gt, d0, d1, d2),
            "fe310b02       vselgt.f64 d0, d1, d2");
    COMPARE(vsel(gt, s0, s1, s2),
            "fe300a81       vselgt.f32 s0, s1, s2");
    COMPARE(vsel(vs, d0, d1, d2),
            "fe110b02       vselvs.f64 d0, d1, d2");
    COMPARE(vsel(vs, s0, s1, s2),
            "fe100a81       vselvs.f32 s0, s1, s2");

    // Inverted conditions (and swapped inputs).
    COMPARE(vsel(ne, d0, d1, d2),
            "fe020b01       vseleq.f64 d0, d2, d1");
    COMPARE(vsel(ne, s0, s1, s2),
            "fe010a20       vseleq.f32 s0, s2, s1");
    COMPARE(vsel(lt, d0, d1, d2),
            "fe220b01       vselge.f64 d0, d2, d1");
    COMPARE(vsel(lt, s0, s1, s2),
            "fe210a20       vselge.f32 s0, s2, s1");
    COMPARE(vsel(le, d0, d1, d2),
            "fe320b01       vselgt.f64 d0, d2, d1");
    COMPARE(vsel(le, s0, s1, s2),
            "fe310a20       vselgt.f32 s0, s2, s1");
    COMPARE(vsel(vc, d0, d1, d2),
            "fe120b01       vselvs.f64 d0, d2, d1");
    COMPARE(vsel(vc, s0, s1, s2),
            "fe110a20       vselvs.f32 s0, s2, s1");
  }

  VERIFY_RUN();
}


TEST_F(DisasmArmTest, Neon) {
  SET_UP();

  if (CpuFeatures::IsSupported(NEON)) {
    CpuFeatureScope scope(&assm, NEON);
      COMPARE(vld1(Neon8, NeonListOperand(d4, 1), NeonMemOperand(r1)),
              "f421470f       vld1.8 {d4}, [r1]");
      COMPARE(vld1(Neon8, NeonListOperand(d4, 2), NeonMemOperand(r1)),
              "f4214a0f       vld1.8 {d4, d5}, [r1]");
      COMPARE(vld1(Neon8, NeonListOperand(d4, 3), NeonMemOperand(r1)),
              "f421460f       vld1.8 {d4, d5, d6}, [r1]");
      COMPARE(vld1(Neon8, NeonListOperand(d4, 4), NeonMemOperand(r1)),
              "f421420f       vld1.8 {d4, d5, d6, d7}, [r1]");
      COMPARE(vld1s(Neon32, NeonListOperand(d4, 1), 0, NeonMemOperand(r1)),
              "f4a1480f       vld1.32 {d4[0]}, [r1]");
      COMPARE(vld1s(Neon16, NeonListOperand(d4, 1), 3, NeonMemOperand(r1)),
              "f4a144cf       vld1.16 {d4[3]}, [r1]");
      COMPARE(vld1r(Neon8, NeonListOperand(d4, 1), NeonMemOperand(r1)),
              "f4a14c0f       vld1.8 {d4}, [r1]");
      COMPARE(vld1r(Neon16, NeonListOperand(d4, 2), NeonMemOperand(r1)),
              "f4a14c6f       vld1.16 {d4, d5}, [r1]");
      COMPARE(vst1(Neon8, NeonListOperand(d4, 1), NeonMemOperand(r6)),
              "f406470f       vst1.8 {d4}, [r6]")
      COMPARE(vst1(Neon8, NeonListOperand(q4), NeonMemOperand(r6)),
              "f4068a0f       vst1.8 {d8, d9}, [r6]")
      COMPARE(vst1(Neon8, NeonListOperand(d4, 3), NeonMemOperand(r6)),
              "f406460f       vst1.8 {d4, d5, d6}, [r6]")
      COMPARE(vst1(Neon16, NeonListOperand(d17, 4), NeonMemOperand(r9)),
              "f449124f       vst1.16 {d17, d18, d19, d20}, [r9]");
      COMPARE(vst1s(Neon8, NeonListOperand(d4), 1, NeonMemOperand(r1)),
              "f481402f       vst1.8 {d4[1]}, [r1]");
      COMPARE(vst1s(Neon16, NeonListOperand(d4), 2, NeonMemOperand(r1)),
              "f481448f       vst1.16 {d4[2]}, [r1]");
      COMPARE(vst1s(Neon32, NeonListOperand(d4), 0, NeonMemOperand(r1)),
              "f481480f       vst1.32 {d4[0]}, [r1]");
      COMPARE(vmovl(NeonU8, q3, d1), "f3886a11       vmovl.u8 q3, d1");
      COMPARE(vmovl(NeonU8, q4, d2), "f3888a12       vmovl.u8 q4, d2");
      COMPARE(vmovl(NeonS16, q4, d2), "f2908a12       vmovl.s16 q4, d2");
      COMPARE(vmovl(NeonU32, q4, d2), "f3a08a12       vmovl.u32 q4, d2");

      COMPARE(vqmovn(NeonU8, NeonU8, d16, q8),
              "f3f202e0       vqmovn.u16 d16, q8");
      COMPARE(vqmovn(NeonS16, NeonS16, d16, q8),
              "f3f602a0       vqmovn.s32 d16, q8");
      COMPARE(vqmovn(NeonU32, NeonU32, d2, q4),
              "f3ba22c8       vqmovn.u64 d2, q4");
      COMPARE(vqmovn(NeonU32, NeonS32, d2, q4),
              "f3ba2248       vqmovun.s64 d2, q4");

      COMPARE(vmov(NeonS8, d0, 0, r0), "ee400b10       vmov.8 d0[0], r0");
      COMPARE(vmov(NeonU8, d1, 1, r1), "ee411b30       vmov.8 d1[1], r1");
      COMPARE(vmov(NeonS8, d2, 2, r2), "ee422b50       vmov.8 d2[2], r2");
      COMPARE(vmov(NeonU8, d3, 3, r8), "ee438b70       vmov.8 d3[3], r8");
      COMPARE(vmov(NeonU8, d3, 3, ip), "ee43cb70       vmov.8 d3[3], ip");
      COMPARE(vmov(NeonS8, d4, 4, r0), "ee640b10       vmov.8 d4[4], r0");
      COMPARE(vmov(NeonU8, d5, 5, r1), "ee651b30       vmov.8 d5[5], r1");
      COMPARE(vmov(NeonS8, d6, 6, r2), "ee662b50       vmov.8 d6[6], r2");
      COMPARE(vmov(NeonU8, d7, 7, r8), "ee678b70       vmov.8 d7[7], r8");
      COMPARE(vmov(NeonS16, d0, 0, r0), "ee000b30       vmov.16 d0[0], r0");
      COMPARE(vmov(NeonS16, d1, 1, r1), "ee011b70       vmov.16 d1[1], r1");
      COMPARE(vmov(NeonS16, d2, 2, r2), "ee222b30       vmov.16 d2[2], r2");
      COMPARE(vmov(NeonS16, d3, 3, r7), "ee237b70       vmov.16 d3[3], r7");
      COMPARE(vmov(NeonS16, d3, 3, ip), "ee23cb70       vmov.16 d3[3], ip");
      COMPARE(vmov(NeonS32, d0, 0, r0), "ee000b10       vmov.32 d0[0], r0");
      COMPARE(vmov(NeonU32, d0, 1, r0), "ee200b10       vmov.32 d0[1], r0");

      COMPARE(vmov(NeonS8, r0, d0, 0), "ee500b10       vmov.s8 r0, d0[0]");
      COMPARE(vmov(NeonU8, r1, d1, 1), "eed11b30       vmov.u8 r1, d1[1]");
      COMPARE(vmov(NeonS8, r2, d2, 2), "ee522b50       vmov.s8 r2, d2[2]");
      COMPARE(vmov(NeonU8, r8, d3, 3), "eed38b70       vmov.u8 r8, d3[3]");
      COMPARE(vmov(NeonS8, r0, d4, 4), "ee740b10       vmov.s8 r0, d4[4]");
      COMPARE(vmov(NeonU8, r1, d5, 5), "eef51b30       vmov.u8 r1, d5[5]");
      COMPARE(vmov(NeonS8, r2, d6, 6), "ee762b50       vmov.s8 r2, d6[6]");
      COMPARE(vmov(NeonU8, r8, d7, 7), "eef78b70       vmov.u8 r8, d7[7]");
      COMPARE(vmov(NeonU8, ip, d7, 7), "eef7cb70       vmov.u8 ip, d7[7]");
      COMPARE(vmov(NeonS16, r0, d0, 0), "ee100b30       vmov.s16 r0, d0[0]");
      COMPARE(vmov(NeonU16, r1, d1, 1), "ee911b70       vmov.u16 r1, d1[1]");
      COMPARE(vmov(NeonS16, r2, d2, 2), "ee322b30       vmov.s16 r2, d2[2]");
      COMPARE(vmov(NeonU16, r7, d3, 3), "eeb37b70       vmov.u16 r7, d3[3]");
      COMPARE(vmov(NeonS32, r2, d15, 0), "ee1f2b10       vmov.32 r2, d15[0]");
      COMPARE(vmov(NeonS32, r3, d14, 1), "ee3e3b10       vmov.32 r3, d14[1]");

      COMPARE(vmov(q0, q15),
              "f22e01fe       vmov q0, q15");
      COMPARE(vmov(q8, q9),
              "f26201f2       vmov q8, q9");
      COMPARE(vmov(q1, 0),
              "f2802050       vmov.i32 q1, 0");
      COMPARE(vmov(q1, 0x0000001200000012),
              "f2812052       vmov.i32 q1, 18");
      COMPARE(vmov(q0, 0xffffffffffffffff),
              "f3870e5f       vmov.i8 q0, 255");
      COMPARE(vmov(d0, 0xffffffffffffffff),
              "f3870e1f       vmov.i8 q0, 255");
      COMPARE(vmvn(q0, q15),
              "f3b005ee       vmvn q0, q15");
      COMPARE(vmvn(q8, q9),
              "f3f005e2       vmvn q8, q9");
      COMPARE(vswp(d0, d31),
              "f3b2002f       vswp d0, d31");
      COMPARE(vswp(d16, d14),
              "f3f2000e       vswp d16, d14");
      COMPARE(vswp(q0, q15),
              "f3b2006e       vswp q0, q15");
      COMPARE(vswp(q8, q9),
              "f3f20062       vswp q8, q9");
      COMPARE(vdup(Neon8, q0, r0),
              "eee00b10       vdup.8 q0, r0");
      COMPARE(vdup(Neon16, q1, r4),
              "eea24b30       vdup.16 q1, r4");
      COMPARE(vdup(Neon32, q15, r1),
              "eeae1b90       vdup.32 q15, r1");
      COMPARE(vdup(Neon32, q0, d1, 1),
              "f3bc0c41       vdup.32 q0, d1[1]");
      COMPARE(vdup(Neon32, q15, d1, 0),
              "f3f4ec41       vdup.32 q15, d1[0]");
      COMPARE(vdup(Neon16, q7, d8, 3),
              "f3beec48       vdup.16 q7, d8[3]");
      COMPARE(vdup(Neon32, d0, d30, 0),
              "f3b40c2e       vdup.32 d0, d30[0]");
      COMPARE(vcvt_f32_s32(q15, q1),
              "f3fbe642       vcvt.f32.s32 q15, q1");
      COMPARE(vcvt_f32_u32(q8, q9),
              "f3fb06e2       vcvt.f32.u32 q8, q9");
      COMPARE(vcvt_s32_f32(q15, q1),
              "f3fbe742       vcvt.s32.f32 q15, q1");
      COMPARE(vcvt_u32_f32(q8, q9),
              "f3fb07e2       vcvt.u32.f32 q8, q9");
      COMPARE(vclt(Neon8, q1, q3, 0),
              "f3b12246       vclt.s8 q1, q3, #0");
      COMPARE(vclt(Neon16, q1, q3, 0),
              "f3b52246       vclt.s16 q1, q3, #0");
      COMPARE(vclt(Neon32, q1, q3, 0),
              "f3b92246       vclt.s32 q1, q3, #0");
      COMPARE(vabs(q0, q1),
              "f3b90742       vabs.f32 q0, q1");
      COMPARE(vabs(Neon8, q6, q7),
              "f3b1c34e       vabs.s8 q6, q7");
      COMPARE(vabs(Neon16, q0, q1),
              "f3b50342       vabs.s16 q0, q1");
      COMPARE(vabs(Neon32, q0, q1),
              "f3b90342       vabs.s32 q0, q1");
      COMPARE(vneg(q0, q1),
              "f3b907c2       vneg.f32 q0, q1");
      COMPARE(vneg(Neon8, q6, q7),
              "f3b1c3ce       vneg.s8 q6, q7");
      COMPARE(vneg(Neon16, q0, q1),
              "f3b503c2       vneg.s16 q0, q1");
      COMPARE(vneg(Neon32, q0, q1),
              "f3b903c2       vneg.s32 q0, q1");
      COMPARE(veor(d0, d1, d2),
              "f3010112       veor d0, d1, d2");
      COMPARE(veor(d0, d30, d31),
              "f30e01bf       veor d0, d30, d31");
      COMPARE(veor(q0, q1, q2),
              "f3020154       veor q0, q1, q2");
      COMPARE(veor(q15, q0, q8),
              "f340e170       veor q15, q0, q8");
      COMPARE(vand(q15, q0, q8),
              "f240e170       vand q15, q0, q8");
      COMPARE(vbic(q15, q0, q8),
              "f250e170       vbic q15, q0, q8");
      COMPARE(vorr(q15, q0, q8),
              "f260e170       vorr q15, q0, q8");
      COMPARE(vmin(q15, q0, q8),
              "f260ef60       vmin.f32 q15, q0, q8");
      COMPARE(vmax(q15, q0, q8),
              "f240ef60       vmax.f32 q15, q0, q8");
      COMPARE(vmax(NeonS8, q0, q1, q2),
              "f2020644       vmax.s8 q0, q1, q2");
      COMPARE(vmin(NeonU16, q1, q2, q8),
              "f3142670       vmin.u16 q1, q2, q8");
      COMPARE(vmax(NeonS32, q15, q0, q8),
              "f260e660       vmax.s32 q15, q0, q8");
      COMPARE(vpadd(d0, d1, d2),
              "f3010d02       vpadd.f32 d0, d1, d2");
      COMPARE(vpadd(Neon8, d0, d1, d2),
              "f2010b12       vpadd.i8 d0, d1, d2");
      COMPARE(vpadd(Neon16, d0, d1, d2),
              "f2110b12       vpadd.i16 d0, d1, d2");
      COMPARE(vpadd(Neon32, d0, d1, d2),
              "f2210b12       vpadd.i32 d0, d1, d2");
      COMPARE(vpadal(NeonS8, q0, q1),
              "f3b00642       vpadal.s8 q0, q1");
      COMPARE(vpadal(NeonS16, q0, q1),
              "f3b40642       vpadal.s16 q0, q1");
      COMPARE(vpadal(NeonS32, q0, q1),
              "f3b80642       vpadal.s32 q0, q1");
      COMPARE(vpadal(NeonU8, q14, q15),
              "f3f0c6ee       vpadal.u8 q14, q15");
      COMPARE(vpadal(NeonU16, q14, q15),
              "f3f4c6ee       vpadal.u16 q14, q15");
      COMPARE(vpadal(NeonU32, q14, q15),
              "f3f8c6ee       vpadal.u32 q14, q15");
      COMPARE(vpaddl(NeonS8, q0, q1),
              "f3b00242       vpaddl.s8 q0, q1");
      COMPARE(vpaddl(NeonS16, q0, q1),
              "f3b40242       vpaddl.s16 q0, q1");
      COMPARE(vpaddl(NeonS32, q0, q1),
              "f3b80242       vpaddl.s32 q0, q1");
      COMPARE(vpaddl(NeonU8, q14, q15),
              "f3f0c2ee       vpaddl.u8 q14, q15");
      COMPARE(vpaddl(NeonU16, q14, q15),
              "f3f4c2ee       vpaddl.u16 q14, q15");
      COMPARE(vpaddl(NeonU32, q14, q15),
              "f3f8c2ee       vpaddl.u32 q14, q15");
      COMPARE(vpmax(NeonS8, d0, d1, d2),
              "f2010a02       vpmax.s8 d0, d1, d2");
      COMPARE(vpmin(NeonU16, d1, d2, d8),
              "f3121a18       vpmin.u16 d1, d2, d8");
      COMPARE(vpmax(NeonS32, d15, d0, d8),
              "f220fa08       vpmax.s32 d15, d0, d8");
      COMPARE(vadd(q15, q0, q8),
              "f240ed60       vadd.f32 q15, q0, q8");
      COMPARE(vadd(Neon8, q0, q1, q2),
              "f2020844       vadd.i8 q0, q1, q2");
      COMPARE(vadd(Neon16, q1, q2, q8),
              "f2142860       vadd.i16 q1, q2, q8");
      COMPARE(vadd(Neon32, q15, q0, q8),
              "f260e860       vadd.i32 q15, q0, q8");
      COMPARE(vqadd(NeonU8, q0, q1, q2),
              "f3020054       vqadd.u8 q0, q1, q2");
      COMPARE(vqadd(NeonS16, q1, q2, q8),
              "f2142070       vqadd.s16 q1, q2, q8");
      COMPARE(vqadd(NeonU32, q15, q0, q8),
              "f360e070       vqadd.u32 q15, q0, q8");
      COMPARE(vsub(q15, q0, q8),
              "f260ed60       vsub.f32 q15, q0, q8");
      COMPARE(vsub(Neon8, q0, q1, q2),
              "f3020844       vsub.i8 q0, q1, q2");
      COMPARE(vsub(Neon16, q1, q2, q8),
              "f3142860       vsub.i16 q1, q2, q8");
      COMPARE(vsub(Neon32, q15, q0, q8),
              "f360e860       vsub.i32 q15, q0, q8");
      COMPARE(vqsub(NeonU8, q0, q1, q2),
              "f3020254       vqsub.u8 q0, q1, q2");
      COMPARE(vqsub(NeonS16, q1, q2, q8),
              "f2142270       vqsub.s16 q1, q2, q8");
      COMPARE(vqsub(NeonU32, q15, q0, q8),
              "f360e270       vqsub.u32 q15, q0, q8");
      COMPARE(vmul(q0, q1, q2),
              "f3020d54       vmul.f32 q0, q1, q2");
      COMPARE(vmul(Neon8, q0, q1, q2),
              "f2020954       vmul.i8 q0, q1, q2");
      COMPARE(vmul(Neon16, q1, q2, q8),
              "f2142970       vmul.i16 q1, q2, q8");
      COMPARE(vmul(Neon32, q15, q0, q8),
              "f260e970       vmul.i32 q15, q0, q8");

      COMPARE(vqrdmulh(NeonS16, q0, q1, q8),
              "f3120b60       vqrdmulh.s16 q0, q1, q8");
      COMPARE(vqrdmulh(NeonS32, q15, q0, q8),
              "f360eb60       vqrdmulh.s32 q15, q0, q8");

      COMPARE(vmull(NeonU8, q15, d0, d8),
              "f3c0ec08       vmull.u8 q15, d0, d8");
      COMPARE(vmull(NeonS16, q15, d0, d8),
              "f2d0ec08       vmull.s16 q15, d0, d8");
      COMPARE(vmull(NeonU32, q15, d0, d8),
              "f3e0ec08       vmull.u32 q15, d0, d8");
      COMPARE(vmlal(NeonU32, q15, d0, d8),
              "f3e0e808       vmlal.u32 q15, d0, d8");

      COMPARE(vshl(NeonS8, q15, q0, 6),
              "f2cee550       vshl.i8 q15, q0, #6");
      COMPARE(vshl(NeonU16, q15, q0, 10),
              "f2dae550       vshl.i16 q15, q0, #10");
      COMPARE(vshl(NeonS32, q15, q0, 17),
              "f2f1e550       vshl.i32 q15, q0, #17");
      COMPARE(vshl(NeonS64, q15, q0, 40),
              "f2e8e5d0       vshl.i64 q15, q0, #40");
      COMPARE(vshl(NeonS8, q15, q0, q1),
              "f242e440       vshl.s8 q15, q0, q1");
      COMPARE(vshl(NeonU16, q15, q2, q3),
              "f356e444       vshl.u16 q15, q2, q3");
      COMPARE(vshl(NeonS32, q15, q4, q5),
              "f26ae448       vshl.s32 q15, q4, q5");
      COMPARE(vshr(NeonS8, q15, q0, 6),
              "f2cae050       vshr.s8 q15, q0, #6");
      COMPARE(vshr(NeonU16, q15, q0, 10),
              "f3d6e050       vshr.u16 q15, q0, #10");
      COMPARE(vshr(NeonS32, q15, q0, 17),
              "f2efe050       vshr.s32 q15, q0, #17");
      COMPARE(vshr(NeonS64, q15, q0, 40),
              "f2d8e0d0       vshr.s64 q15, q0, #40");
      COMPARE(vshr(NeonU64, q15, q0, 40),
              "f3d8e0d0       vshr.u64 q15, q0, #40");
      COMPARE(vsli(Neon64, d2, d0, 32),
              "f3a02590       vsli.64 d2, d0, #32");
      COMPARE(vsli(Neon32, d7, d8, 17),
              "f3b17518       vsli.32 d7, d8, #17");
      COMPARE(vsri(Neon64, d2, d0, 32),
              "f3a02490       vsri.64 d2, d0, #32");
      COMPARE(vsri(Neon16, d7, d8, 8),
              "f3987418       vsri.16 d7, d8, #8");
      COMPARE(vrecpe(q15, q0),
              "f3fbe540       vrecpe.f32 q15, q0");
      COMPARE(vrecps(q15, q0, q8),
              "f240ef70       vrecps.f32 q15, q0, q8");
      COMPARE(vrsqrte(q15, q0),
              "f3fbe5c0       vrsqrte.f32 q15, q0");
      COMPARE(vrsqrts(q15, q0, q8),
              "f260ef70       vrsqrts.f32 q15, q0, q8");
      COMPARE(vtst(Neon8, q0, q1, q2),
              "f2020854       vtst.i8 q0, q1, q2");
      COMPARE(vtst(Neon16, q1, q2, q8),
              "f2142870       vtst.i16 q1, q2, q8");
      COMPARE(vtst(Neon32, q15, q0, q8),
              "f260e870       vtst.i32 q15, q0, q8");
      COMPARE(vceq(q0, q1, q2),
              "f2020e44       vceq.f32 q0, q1, q2");
      COMPARE(vcge(q0, q1, q2),
              "f3020e44       vcge.f32 q0, q1, q2");
      COMPARE(vcgt(q0, q1, q2),
              "f3220e44       vcgt.f32 q0, q1, q2");
      COMPARE(vceq(Neon8, q0, q1, q2),
              "f3020854       vceq.i8 q0, q1, q2");
      COMPARE(vceq(Neon16, q1, q2, q8),
              "f3142870       vceq.i16 q1, q2, q8");
      COMPARE(vceq(Neon32, q15, q0, q8),
              "f360e870       vceq.i32 q15, q0, q8");
      COMPARE(vcge(NeonS8, q0, q1, q2),
              "f2020354       vcge.s8 q0, q1, q2");
      COMPARE(vcge(NeonU16, q1, q2, q8),
              "f3142370       vcge.u16 q1, q2, q8");
      COMPARE(vcge(NeonS32, q15, q0, q8),
              "f260e370       vcge.s32 q15, q0, q8");
      COMPARE(vcgt(NeonS8, q0, q1, q2),
              "f2020344       vcgt.s8 q0, q1, q2");
      COMPARE(vcgt(NeonU16, q1, q2, q8),
              "f3142360       vcgt.u16 q1, q2, q8");
      COMPARE(vcgt(NeonS32, q15, q0, q8),
              "f260e360       vcgt.s32 q15, q0, q8");
      COMPARE(vrhadd(NeonU8, q0, q1, q2),
              "f3020144       vrhadd.u8 q0, q1, q2");
      COMPARE(vrhadd(NeonU16, q1, q2, q8),
              "f3142160       vrhadd.u16 q1, q2, q8");
      COMPARE(vrhadd(NeonU32, q15, q0, q8),
              "f360e160       vrhadd.u32 q15, q0, q8");
      COMPARE(vbsl(q0, q1, q2),
              "f3120154       vbsl q0, q1, q2");
      COMPARE(vbsl(q15, q0, q8),
              "f350e170       vbsl q15, q0, q8");
      COMPARE(vext(q15, q0, q8, 3),
              "f2f0e360       vext.8 q15, q0, q8, #3");
      COMPARE(vzip(Neon16, d15, d0),
              "f3b6f180       vzip.16 d15, d0");
      COMPARE(vzip(Neon16, q15, q0),
              "f3f6e1c0       vzip.16 q15, q0");
      COMPARE(vuzp(Neon16, d15, d0),
              "f3b6f100       vuzp.16 d15, d0");
      COMPARE(vuzp(Neon16, q15, q0),
              "f3f6e140       vuzp.16 q15, q0");
      COMPARE(vrev16(Neon8, q15, q0),
              "f3f0e140       vrev16.8 q15, q0");
      COMPARE(vrev32(Neon8, q15, q0),
              "f3f0e0c0       vrev32.8 q15, q0");
      COMPARE(vrev64(Neon8, q15, q0),
              "f3f0e040       vrev64.8 q15, q0");
      COMPARE(vtrn(Neon16, d15, d0),
              "f3b6f080       vtrn.16 d15, d0");
      COMPARE(vtrn(Neon16, q15, q0),
              "f3f6e0c0       vtrn.16 q15, q0");
      COMPARE(vtbl(d0, NeonListOperand(d1, 1), d2),
              "f3b10802       vtbl.8 d0, {d1}, d2");
      COMPARE(vtbl(d31, NeonListOperand(d0, 2), d4),
              "f3f0f904       vtbl.8 d31, {d0, d1}, d4");
      COMPARE(vtbl(d15, NeonListOperand(d1, 3), d5),
              "f3b1fa05       vtbl.8 d15, {d1, d2, d3}, d5");
      COMPARE(vtbl(d15, NeonListOperand(d1, 4), d5),
              "f3b1fb05       vtbl.8 d15, {d1, d2, d3, d4}, d5");
      COMPARE(vtbx(d0, NeonListOperand(d1, 1), d2),
              "f3b10842       vtbx.8 d0, {d1}, d2");
      COMPARE(vtbx(d31, NeonListOperand(d0, 2), d4),
              "f3f0f944       vtbx.8 d31, {d0, d1}, d4");
      COMPARE(vtbx(d15, NeonListOperand(d1, 3), d5),
              "f3b1fa45       vtbx.8 d15, {d1, d2, d3}, d5");
      COMPARE(vtbx(d15, NeonListOperand(d1, 4), d5),
              "f3b1fb45       vtbx.8 d15, {d1, d2, d3, d4}, d5");
      COMPARE(vcnt(q1, q2),
              "f3b02544       vcnt.8 q1, q2");
  }

  VERIFY_RUN();
}


TEST_F(DisasmArmTest, LoadStore) {
  SET_UP();

  COMPARE(ldrb(r0, MemOperand(r1)),
          "e5d10000       ldrb r0, [r1, #+0]");
  COMPARE(ldrb(r2, MemOperand(r3, 42)),
          "e5d3202a       ldrb r2, [r3, #+42]");
  COMPARE(ldrb(r4, MemOperand(r5, -42)),
          "e555402a       ldrb r4, [r5, #-42]");
  COMPARE(ldrb(r6, MemOperand(r7, 42, PostIndex)),
          "e4d7602a       ldrb r6, [r7], #+42");
  COMPARE(ldrb(r8, MemOperand(r9, -42, PostIndex)),
          "e459802a       ldrb r8, [r9], #-42");
  COMPARE(ldrb(r10, MemOperand(fp, 42, PreIndex)),
          "e5fba02a       ldrb r10, [fp, #+42]!");
  COMPARE(ldrb(ip, MemOperand(sp, -42, PreIndex)),
          "e57dc02a       ldrb ip, [sp, #-42]!");
  COMPARE(ldrb(r0, MemOperand(r1, r2)),
          "e7d10002       ldrb r0, [r1, +r2]");
  COMPARE(ldrb(r0, MemOperand(r1, r2, NegOffset)),
          "e7510002       ldrb r0, [r1, -r2]");
  COMPARE(ldrb(r0, MemOperand(r1, r2, PostIndex)),
          "e6d10002       ldrb r0, [r1], +r2");
  COMPARE(ldrb(r0, MemOperand(r1, r2, NegPostIndex)),
          "e6510002       ldrb r0, [r1], -r2");
  COMPARE(ldrb(r0, MemOperand(r1, r2, PreIndex)),
          "e7f10002       ldrb r0, [r1, +r2]!");
  COMPARE(ldrb(r0, MemOperand(r1, r2, NegPreIndex)),
          "e7710002       ldrb r0, [r1, -r2]!");

  COMPARE(strb(r0, MemOperand(r1)),
          "e5c10000       strb r0, [r1, #+0]");
  COMPARE(strb(r2, MemOperand(r3, 42)),
          "e5c3202a       strb r2, [r3, #+42]");
  COMPARE(strb(r4, MemOperand(r5, -42)),
          "e545402a       strb r4, [r5, #-42]");
  COMPARE(strb(r6, MemOperand(r7, 42, PostIndex)),
          "e4c7602a       strb r6, [r7], #+42");
  COMPARE(strb(r8, MemOperand(r9, -42, PostIndex)),
          "e449802a       strb r8, [r9], #-42");
  COMPARE(strb(r10, MemOperand(fp, 42, PreIndex)),
          "e5eba02a       strb r10, [fp, #+42]!");
  COMPARE(strb(ip, MemOperand(sp, -42, PreIndex)),
          "e56dc02a       strb ip, [sp, #-42]!");
  COMPARE(strb(r0, MemOperand(r1, r2)),
          "e7c10002       strb r0, [r1, +r2]");
  COMPARE(strb(r0, MemOperand(r1, r2, NegOffset)),
          "e7410002       strb r0, [r1, -r2]");
  COMPARE(strb(r0, MemOperand(r1, r2, PostIndex)),
          "e6c10002       strb r0, [r1], +r2");
  COMPARE(strb(r0, MemOperand(r1, r2, NegPostIndex)),
          "e6410002       strb r0, [r1], -r2");
  COMPARE(strb(r0, MemOperand(r1, r2, PreIndex)),
          "e7e10002       strb r0, [r1, +r2]!");
  COMPARE(strb(r0, MemOperand(r1, r2, NegPreIndex)),
          "e7610002       strb r0, [r1, -r2]!");

  COMPARE(ldrh(r0, MemOperand(r1)),
          "e1d100b0       ldrh r0, [r1, #+0]");
  COMPARE(ldrh(r2, MemOperand(r3, 42)),
          "e1d322ba       ldrh r2, [r3, #+42]");
  COMPARE(ldrh(r4, MemOperand(r5, -42)),
          "e15542ba       ldrh r4, [r5, #-42]");
  COMPARE(ldrh(r6, MemOperand(r7, 42, PostIndex)),
          "e0d762ba       ldrh r6, [r7], #+42");
  COMPARE(ldrh(r8, MemOperand(r9, -42, PostIndex)),
          "e05982ba       ldrh r8, [r9], #-42");
  COMPARE(ldrh(r10, MemOperand(fp, 42, PreIndex)),
          "e1fba2ba       ldrh r10, [fp, #+42]!");
  COMPARE(ldrh(ip, MemOperand(sp, -42, PreIndex)),
          "e17dc2ba       ldrh ip, [sp, #-42]!");
  COMPARE(ldrh(r0, MemOperand(r1, r2)),
          "e19100b2       ldrh r0, [r1, +r2]");
  COMPARE(ldrh(r0, MemOperand(r1, r2, NegOffset)),
          "e11100b2       ldrh r0, [r1, -r2]");
  COMPARE(ldrh(r0, MemOperand(r1, r2, PostIndex)),
          "e09100b2       ldrh r0, [r1], +r2");
  COMPARE(ldrh(r0, MemOperand(r1, r2, NegPostIndex)),
          "e01100b2       ldrh r0, [r1], -r2");
  COMPARE(ldrh(r0, MemOperand(r1, r2, PreIndex)),
          "e1b100b2       ldrh r0, [r1, +r2]!");
  COMPARE(ldrh(r0, MemOperand(r1, r2, NegPreIndex)),
          "e13100b2       ldrh r0, [r1, -r2]!");

  COMPARE(strh(r0, MemOperand(r1)),
          "e1c100b0       strh r0, [r1, #+0]");
  COMPARE(strh(r2, MemOperand(r3, 42)),
          "e1c322ba       strh r2, [r3, #+42]");
  COMPARE(strh(r4, MemOperand(r5, -42)),
          "e14542ba       strh r4, [r5, #-42]");
  COMPARE(strh(r6, MemOperand(r7, 42, PostIndex)),
          "e0c762ba       strh r6, [r7], #+42");
  COMPARE(strh(r8, MemOperand(r9, -42, PostIndex)),
          "e04982ba       strh r8, [r9], #-42");
  COMPARE(strh(r10, MemOperand(fp, 42, PreIndex)),
          "e1eba2ba       strh r10, [fp, #+42]!");
  COMPARE(strh(ip, MemOperand(sp, -42, PreIndex)),
          "e16dc2ba       strh ip, [sp, #-42]!");
  COMPARE(strh(r0, MemOperand(r1, r2)),
          "e18100b2       strh r0, [r1, +r2]");
  COMPARE(strh(r0, MemOperand(r1, r2, NegOffset)),
          "e10100b2       strh r0, [r1, -r2]");
  COMPARE(strh(r0, MemOperand(r1, r2, PostIndex)),
          "e08100b2       strh r0, [r1], +r2");
  COMPARE(strh(r0, MemOperand(r1, r2, NegPostIndex)),
          "e00100b2       strh r0, [r1], -r2");
  COMPARE(strh(r0, MemOperand(r1, r2, PreIndex)),
          "e1a100b2       strh r0, [r1, +r2]!");
  COMPARE(strh(r0, MemOperand(r1, r2, NegPreIndex)),
          "e12100b2       strh r0, [r1, -r2]!");

  COMPARE(ldr(r0, MemOperand(r1)),
          "e5910000       ldr r0, [r1, #+0]");
  COMPARE(ldr(r2, MemOperand(r3, 42)),
          "e593202a       ldr r2, [r3, #+42]");
  COMPARE(ldr(r4, MemOperand(r5, -42)),
          "e515402a       ldr r4, [r5, #-42]");
  COMPARE(ldr(r6, MemOperand(r7, 42, PostIndex)),
          "e497602a       ldr r6, [r7], #+42");
  COMPARE(ldr(r8, MemOperand(r9, -42, PostIndex)),
          "e419802a       ldr r8, [r9], #-42");
  COMPARE(ldr(r10, MemOperand(fp, 42, PreIndex)),
          "e5bba02a       ldr r10, [fp, #+42]!");
  COMPARE(ldr(ip, MemOperand(sp, -42, PreIndex)),
          "e53dc02a       ldr ip, [sp, #-42]!");
  COMPARE(ldr(r0, MemOperand(r1, r2)),
          "e7910002       ldr r0, [r1, +r2]");
  COMPARE(ldr(r0, MemOperand(r1, r2, NegOffset)),
          "e7110002       ldr r0, [r1, -r2]");
  COMPARE(ldr(r0, MemOperand(r1, r2, PostIndex)),
          "e6910002       ldr r0, [r1], +r2");
  COMPARE(ldr(r0, MemOperand(r1, r2, NegPostIndex)),
          "e6110002       ldr r0, [r1], -r2");
  COMPARE(ldr(r0, MemOperand(r1, r2, PreIndex)),
          "e7b10002       ldr r0, [r1, +r2]!");
  COMPARE(ldr(r0, MemOperand(r1, r2, NegPreIndex)),
          "e7310002       ldr r0, [r1, -r2]!");

  COMPARE(str(r0, MemOperand(r1)),
          "e5810000       str r0, [r1, #+0]");
  COMPARE(str(r2, MemOperand(r3, 42)),
          "e583202a       str r2, [r3, #+42]");
  COMPARE(str(r4, MemOperand(r5, -42)),
          "e505402a       str r4, [r5, #-42]");
  COMPARE(str(r6, MemOperand(r7, 42, PostIndex)),
          "e487602a       str r6, [r7], #+42");
  COMPARE(str(r8, MemOperand(r9, -42, PostIndex)),
          "e409802a       str r8, [r9], #-42");
  COMPARE(str(r10, MemOperand(fp, 42, PreIndex)),
          "e5aba02a       str r10, [fp, #+42]!");
  COMPARE(str(ip, MemOperand(sp, -42, PreIndex)),
          "e52dc02a       str ip, [sp, #-42]!");
  COMPARE(str(r0, MemOperand(r1, r2)),
          "e7810002       str r0, [r1, +r2]");
  COMPARE(str(r0, MemOperand(r1, r2, NegOffset)),
          "e7010002       str r0, [r1, -r2]");
  COMPARE(str(r0, MemOperand(r1, r2, PostIndex)),
          "e6810002       str r0, [r1], +r2");
  COMPARE(str(r0, MemOperand(r1, r2, NegPostIndex)),
          "e6010002       str r0, [r1], -r2");
  COMPARE(str(r0, MemOperand(r1, r2, PreIndex)),
          "e7a10002       str r0, [r1, +r2]!");
  COMPARE(str(r0, MemOperand(r1, r2, NegPreIndex)),
          "e7210002       str r0, [r1, -r2]!");

  if (CpuFeatures::IsSupported(ARMv7)) {
    CpuFeatureScope scope(&assm, ARMv7);
    COMPARE(ldrd(r0, r1, MemOperand(r1)),
            "e1c100d0       ldrd r0, [r1, #+0]");
    COMPARE(ldrd(r2, r3, MemOperand(r3, 127)),
            "e1c327df       ldrd r2, [r3, #+127]");
    COMPARE(ldrd(r4, r5, MemOperand(r5, -127)),
            "e14547df       ldrd r4, [r5, #-127]");
    COMPARE(ldrd(r6, r7, MemOperand(r7, 127, PostIndex)),
            "e0c767df       ldrd r6, [r7], #+127");
    COMPARE(ldrd(r8, r9, MemOperand(r9, -127, PostIndex)),
            "e04987df       ldrd r8, [r9], #-127");
    COMPARE(ldrd(r10, fp, MemOperand(fp, 127, PreIndex)),
            "e1eba7df       ldrd r10, [fp, #+127]!");
    COMPARE(ldrd(ip, sp, MemOperand(sp, -127, PreIndex)),
            "e16dc7df       ldrd ip, [sp, #-127]!");

    COMPARE(strd(r0, r1, MemOperand(r1)),
            "e1c100f0       strd r0, [r1, #+0]");
    COMPARE(strd(r2, r3, MemOperand(r3, 127)),
            "e1c327ff       strd r2, [r3, #+127]");
    COMPARE(strd(r4, r5, MemOperand(r5, -127)),
            "e14547ff       strd r4, [r5, #-127]");
    COMPARE(strd(r6, r7, MemOperand(r7, 127, PostIndex)),
            "e0c767ff       strd r6, [r7], #+127");
    COMPARE(strd(r8, r9, MemOperand(r9, -127, PostIndex)),
            "e04987ff       strd r8, [r9], #-127");
    COMPARE(strd(r10, fp, MemOperand(fp, 127, PreIndex)),
            "e1eba7ff       strd r10, [fp, #+127]!");
    COMPARE(strd(ip, sp, MemOperand(sp, -127, PreIndex)),
            "e16dc7ff       strd ip, [sp, #-127]!");

    COMPARE(pld(MemOperand(r1, 0)),
            "f5d1f000       pld [r1]");
    COMPARE(pld(MemOperand(ip, 64)),
            "f5dcf040       pld [ip, #+64]");
    COMPARE(pld(
"""


```