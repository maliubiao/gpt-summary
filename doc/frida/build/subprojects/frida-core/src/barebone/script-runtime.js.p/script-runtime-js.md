Response:
The user wants a summary of the functionality of the `script-runtime.js` file in Frida, along with explanations related to low-level aspects like binary operations and Linux kernel interactions. They also request examples of how to replicate the debugging functionalities using LLDB, along with common usage errors and steps to reach this code.

**Plan:**

1. **Analyze the code:** Read through `script-runtime.js` to identify its core functionalities.
2. **Summarize functionalities:** Group the identified functionalities into logical categories.
3. **Identify low-level interactions:** Pinpoint parts of the code that interact with binary data, memory, or the operating system.
4. **Explain with examples:**  Provide concrete examples of how these low-level interactions work.
5. **LLDB examples:**  If the code implements debugging features, demonstrate how to achieve similar results with LLDB.
6. **Logical reasoning (if applicable):**  If the code involves conditional logic or data transformation, create simple input/output examples.
7. **Common usage errors:** Think about how a user might misuse the provided API.
8. **User journey:** Describe a typical scenario where a user might interact with Frida, leading to the execution of this code.è¿™æ˜¯ä¸€ä¸ªFridaçš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£åœ¨ç›®æ ‡è¿›ç¨‹ä¸­è¿è¡ŒJavaScriptä»£ç ï¼Œå¹¶æä¾›ä¸Frida Agentäº¤äº’çš„åŸºç¡€è®¾æ–½ã€‚ å®ƒçš„ä¸»è¦åŠŸèƒ½å¯ä»¥å½’çº³å¦‚ä¸‹ï¼š

**1. JavaScript è¿è¡Œç¯å¢ƒåˆå§‹åŒ–å’Œç®¡ç†:**

* **æä¾›å…¨å±€å¯¹è±¡å’ŒåŸºç¡€ API:**  å®ƒåˆ›å»ºäº†ä¸€ä¸ªå…¨å±€ JavaScript å¯¹è±¡ (`globalThis` æˆ– `global`)ï¼Œå¹¶æ³¨å…¥äº† Frida æä¾›çš„æ ¸å¿ƒ APIï¼Œä¾‹å¦‚ `NativePointer`ï¼Œ`NativeFunction`ï¼Œ`NativeCallback`ï¼Œ`Module`ï¼Œ`console`ï¼Œ`hexdump` ç­‰ã€‚è¿™äº› API ä½¿å¾— JavaScript ä»£ç èƒ½å¤Ÿä¸ç›®æ ‡è¿›ç¨‹çš„å†…å­˜å’Œå‡½æ•°è¿›è¡Œäº¤äº’ã€‚
* **å¼‚å¸¸å¤„ç†:** æ•è· JavaScript ä»£ç ä¸­å‘ç”Ÿçš„å¼‚å¸¸ï¼Œå¹¶å°†è¿™äº›å¼‚å¸¸ä¿¡æ¯é€šè¿‡æ¶ˆæ¯æœºåˆ¶å‘é€å› Frida Agentã€‚è¿™æœ‰åŠ©äºå¼€å‘è€…äº†è§£è„šæœ¬è¿è¡Œæ—¶çš„é”™è¯¯ã€‚

**2. ä¸ Frida Agent çš„é€šä¿¡:**

* **æ¶ˆæ¯åˆ†å‘ (`MessageDispatcher`):**  ç®¡ç† JavaScript ä»£ç å’Œ Frida Agent ä¹‹é—´çš„åŒå‘é€šä¿¡ã€‚å®ƒæ¥æ”¶æ¥è‡ª Agent çš„æ¶ˆæ¯ï¼Œå¹¶æ ¹æ®æ¶ˆæ¯ç±»å‹è¿›è¡Œåˆ†å‘å¤„ç†ã€‚åŒæ ·ï¼ŒJavaScript ä»£ç å¯ä»¥é€šè¿‡ `send` å‡½æ•°å‘ Agent å‘é€æ¶ˆæ¯ã€‚
* **RPC (è¿œç¨‹è¿‡ç¨‹è°ƒç”¨):**  å…è®¸ Agent è°ƒç”¨ JavaScript ä»£ç ä¸­å¯¼å‡ºçš„å‡½æ•° (`rpc.exports`)ï¼Œå¹¶æ¥æ”¶è¿”å›å€¼ã€‚JavaScript ä»£ç ä¹Ÿå¯ä»¥é€šè¿‡ `recv` å‡½æ•°æ³¨å†Œæ¶ˆæ¯å¤„ç†å›è°ƒã€‚

**3. ç±»å‹è½¬æ¢å’Œå†…å­˜æ“ä½œ:**

* **åŸºæœ¬ç±»å‹å°è£… (`BNativePointer`, `BInt64`, `BUInt64`):**  æä¾›äº†å¯¹ç›®æ ‡è¿›ç¨‹å†…å­˜åœ°å€ã€æœ‰ç¬¦å·/æ— ç¬¦å· 64 ä½æ•´æ•°çš„å°è£…ï¼Œä½¿å¾—åœ¨ JavaScript ä¸­æ“ä½œè¿™äº›ç±»å‹æ›´åŠ æ–¹ä¾¿å’Œå®‰å…¨ã€‚è¿™äº›å°è£…ç±»æä¾›äº†å„ç§ç®—æœ¯è¿ç®—ã€ä½è¿ç®—å’Œæ¯”è¾ƒæ“ä½œã€‚
* **å†…å­˜è¯»å†™ (`read*`, `write*` æ–¹æ³•):** `BNativePointer` ç±»æä¾›äº†è¯»å–å’Œå†™å…¥ç›®æ ‡è¿›ç¨‹å†…å­˜çš„æ–¹æ³•ï¼Œæ”¯æŒå„ç§æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚ï¼Œ`readU32`, `writeByteArray`ï¼‰ã€‚

**4. ä¸ç›®æ ‡è¿›ç¨‹äº¤äº’çš„æ ¸å¿ƒ API:**

* **`NativePointer`:**  ç”¨äºè¡¨ç¤ºç›®æ ‡è¿›ç¨‹ä¸­çš„å†…å­˜åœ°å€ã€‚å¯ä»¥è¿›è¡ŒæŒ‡é’ˆè¿ç®—ã€‚
    * **äºŒè¿›åˆ¶åº•å±‚ä¸¾ä¾‹:**  `new NativePointer(0x7ffff7a00000)` åˆ›å»ºä¸€ä¸ªæŒ‡å‘åœ°å€ `0x7ffff7a00000` çš„æŒ‡é’ˆã€‚å¯ä»¥é€šè¿‡ `ptr.readU32()` è¯»å–è¯¥åœ°å€å¼€å§‹çš„ 4 ä¸ªå­—èŠ‚çš„æ— ç¬¦å·æ•´æ•°ã€‚
* **`NativeFunction`:**  ç”¨äºè°ƒç”¨ç›®æ ‡è¿›ç¨‹ä¸­çš„å‡½æ•°ã€‚
    * **äºŒè¿›åˆ¶åº•å±‚ï¼ŒLinuxå†…æ ¸ä¸¾ä¾‹:** å‡è®¾è¦è°ƒç”¨ `libc.so` ä¸­çš„ `open` å‡½æ•°ï¼Œå¯ä»¥å…ˆæ‰¾åˆ°è¯¥å‡½æ•°çš„åœ°å€ï¼Œç„¶åä½¿ç”¨ `new NativeFunction(address, 'int', ['pointer', 'int'])` åˆ›å»ºä¸€ä¸ª `NativeFunction` å¯¹è±¡ï¼Œå…¶ä¸­ `'int'` æ˜¯è¿”å›å€¼ç±»å‹ï¼Œ`['pointer', 'int']` æ˜¯å‚æ•°ç±»å‹ã€‚
* **`NativeCallback`:**  å…è®¸åœ¨ JavaScript ä¸­å®šä¹‰ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå¹¶å°†å…¶æš´éœ²ç»™ç›®æ ‡è¿›ç¨‹ä¸­çš„ native ä»£ç è°ƒç”¨ã€‚
    * **äºŒè¿›åˆ¶åº•å±‚ï¼ŒLinuxå†…æ ¸ä¸¾ä¾‹:** å¯ä»¥åˆ›å»ºä¸€ä¸ª `NativeCallback` æ¥å¤„ç†ç›®æ ‡è¿›ç¨‹ä¸­æŸä¸ª hook ç‚¹çš„å›è°ƒã€‚å›è°ƒå‡½æ•°çš„å‚æ•°å°†ç”± Frida è‡ªåŠ¨ä» native ä»£ç è½¬æ¢ä¸º JavaScript ç±»å‹ã€‚
* **`Module`:**  æä¾›äº†è®¿é—®ç›®æ ‡è¿›ç¨‹åŠ è½½çš„æ¨¡å—ï¼ˆä¾‹å¦‚ï¼Œå…±äº«åº“ï¼‰çš„åŠŸèƒ½ã€‚å¯ä»¥æŸ¥æ‰¾æ¨¡å—çš„å¯¼å‡ºå‡½æ•°ã€‚
    * **äºŒè¿›åˆ¶åº•å±‚ï¼ŒLinuxå†…æ ¸ä¸¾ä¾‹:** `Module.findExportByName('libc.so.6', 'open')` å¯ä»¥æ‰¾åˆ° `libc.so.6` ä¸­ `open` å‡½æ•°çš„åœ°å€ã€‚
* **`console`:**  æä¾›äº†ç±»ä¼¼äºæµè§ˆå™¨æ§åˆ¶å°çš„è¾“å‡ºåŠŸèƒ½ï¼Œç”¨äºåœ¨ Frida Agent ä¸­æ‰“å°æ—¥å¿—ä¿¡æ¯ã€‚
* **`hexdump`:**  ä»¥åå…­è¿›åˆ¶æ ¼å¼æ‰“å°å†…å­˜å†…å®¹ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚

**5. å…¶ä»–åŠŸèƒ½:**

* **`Script` å¯¹è±¡:**  æä¾›äº†ä¸€äº›å…³äºå½“å‰è„šæœ¬è¿è¡Œæ—¶çš„ä¿¡æ¯ï¼Œä¾‹å¦‚è¿è¡Œæ—¶å¼•æ“ (ç›®å‰æ˜¯ "QJS")ã€‚
* **`Process` å¯¹è±¡:**  æä¾›äº†å…³äºç›®æ ‡è¿›ç¨‹çš„ä¿¡æ¯ï¼Œä¾‹å¦‚è¿›ç¨‹ IDï¼Œå¹³å°ï¼Œä»£ç ç­¾åç­–ç•¥ç­‰ã€‚è¿˜å¯ä»¥æšä¸¾ç›®æ ‡è¿›ç¨‹åŠ è½½çš„æ¨¡å—ã€‚
    * **Linuxå†…æ ¸ä¸¾ä¾‹:**  `Process.enumerateModules()` å¯ä»¥åˆ—å‡ºç›®æ ‡è¿›ç¨‹åŠ è½½çš„æ‰€æœ‰å…±äº«åº“ï¼ŒåŒ…æ‹¬å†…æ ¸ç›¸å…³çš„æ¨¡å—ï¼ˆå°½ç®¡ç›´æ¥è®¿é—®å†…æ ¸æ¨¡å—å¯èƒ½å—åˆ°æƒé™é™åˆ¶ï¼‰ã€‚

**LLDB å¤åˆ»ç¤ºä¾‹ (å¦‚æœæºä»£ç æ˜¯è°ƒè¯•åŠŸèƒ½çš„å®ç°):**

`script-runtime.js` æœ¬èº«å°±å®ç°äº† Frida çš„æ ¸å¿ƒè°ƒè¯•åŠŸèƒ½ã€‚  å¦‚æœä½ æƒ³ç”¨ LLDB å¤åˆ»æŸäº›åŠŸèƒ½ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š

* **å¤åˆ» `hexdump` åŠŸèƒ½:**

   å‡è®¾ä½ åœ¨ Frida è„šæœ¬ä¸­ä½¿ç”¨äº† `hexdump(ptr)`ï¼Œå…¶ä¸­ `ptr` æ˜¯ä¸€ä¸ª `NativePointer` å¯¹è±¡ã€‚åœ¨ LLDB ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ `memory read` å‘½ä»¤æ¥æŸ¥çœ‹å†…å­˜ï¼š

   ```lldb
   memory read --format x --size 1 -c 256 <address_of_ptr>
   ```

   å…¶ä¸­ `<address_of_ptr>` éœ€è¦æ›¿æ¢ä¸º `ptr` å¯¹è±¡åœ¨ç›®æ ‡è¿›ç¨‹ä¸­çš„å®é™…å†…å­˜åœ°å€ã€‚ä½ éœ€è¦å…ˆé€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ Frida Agent å‘é€ç»™ä½ çš„ä¿¡æ¯ï¼‰è·å–è¿™ä¸ªåœ°å€ã€‚

* **æŸ¥çœ‹ `NativePointer` æŒ‡å‘çš„å†…å­˜:**

   å¦‚æœ Frida è„šæœ¬ä¸­æœ‰ `ptr.readU32()`ï¼Œä½ å¯ä»¥ä½¿ç”¨ LLDB çš„ `p *(uint32_t *)<address_of_ptr>` å‘½ä»¤æŸ¥çœ‹ã€‚

* **è°ƒç”¨ç›®æ ‡è¿›ç¨‹å‡½æ•° (éœ€è¦ä¸€äº›å‡†å¤‡å·¥ä½œ):**

   åœ¨ LLDB ä¸­ç›´æ¥è°ƒç”¨ä»»æ„å‡½æ•°æ¯”è¾ƒå¤æ‚ï¼Œä½ éœ€è¦çŸ¥é“å‡½æ•°çš„åœ°å€ã€å‚æ•°ç±»å‹å’Œè°ƒç”¨çº¦å®šã€‚ ä¸€ç§æ–¹æ³•æ˜¯å…ˆåœ¨ Frida è„šæœ¬ä¸­ä½¿ç”¨ `NativeFunction` è·å–å‡½æ•°çš„åœ°å€ï¼Œç„¶åå°†åœ°å€ä¼ é€’ç»™ LLDBï¼Œå¹¶ä½¿ç”¨ `call` å‘½ä»¤è°ƒç”¨ï¼š

   ```lldb
   // Frida è„šæœ¬ä¸­:
   const openPtr = Module.findExportByName('libc.so.6', 'open');
   send({ openAddress: openPtr.toString() });

   // LLDB ä¸­ (å‡è®¾æ”¶åˆ°äº† openAddress):
   p (int)open((const char *)"/tmp/test.txt", 0)
   ```

**é€»è¾‘æ¨ç†ç¤ºä¾‹:**

`MessageDispatcher` ç»„ä»¶æ ¹æ®æ¶ˆæ¯çš„ `type` å­—æ®µå°†æ¶ˆæ¯åˆ†å‘ç»™ä¸åŒçš„å¤„ç†ç¨‹åºã€‚

**å‡è®¾è¾“å…¥ (æ¥è‡ª Frida Agent çš„æ¶ˆæ¯):**

```json
{ "type": "log", "level": "info", "payload": ["Hello", "world"] }
```

**è¾“å‡º (æ ¹æ® `console.js` çš„é€»è¾‘):**

è¯¥æ¶ˆæ¯ä¼šè¢« `MessageDispatcher` è·¯ç”±åˆ° `console` å¯¹è±¡çš„å¤„ç†å‡½æ•°ï¼Œæœ€ç»ˆä¼šè°ƒç”¨ `_send(JSON.stringify(n), null)`ï¼Œå°†ä»¥ä¸‹ JSON å‘é€å› Agentï¼š

```json
{ "type": "log", "level": "info", "payload": "Hello world" }
```

**å¸¸è§ä½¿ç”¨é”™è¯¯:**

* **é”™è¯¯çš„ç±»å‹è½¬æ¢:**  å°è¯•å°†ä¸€ä¸ªé `NativePointer` å¯¹è±¡ä¼ é€’ç»™éœ€è¦ `NativePointer` çš„ APIï¼Œä¾‹å¦‚ `hexdump` æˆ– `ptr.readU32()`ã€‚
    * **ä¸¾ä¾‹:**  `hexdump(12345)`  ä¼šå› ä¸º `12345` ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å†…å­˜åœ°å€è€ŒæŠ¥é”™ã€‚
* **è®¿é—®æ— æ•ˆå†…å­˜åœ°å€:**  ä½¿ç”¨ `NativePointer` æŒ‡å‘ä¸€ä¸ªæœªåˆ†é…æˆ–å·²é‡Šæ”¾çš„å†…å­˜åŒºåŸŸï¼Œä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–å…¶ä»–ä¸å¯é¢„æµ‹çš„è¡Œä¸ºã€‚
    * **ä¸¾ä¾‹:**  å¦‚æœä¸€ä¸ª native å‡½æ•°è¿”å›äº†ä¸€ä¸ªå±€éƒ¨å˜é‡çš„åœ°å€ï¼Œåœ¨å‡½æ•°è¿”å›åå°è¯•è®¿é—®è¯¥åœ°å€å°†ä¼šå‡ºé”™ã€‚
* **åœ¨ `NativeCallback` ä¸­ä½¿ç”¨ä¸å…¼å®¹çš„å‚æ•°/è¿”å›å€¼ç±»å‹:** `NativeCallback` çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹å¿…é¡»ä¸ native ä»£ç çš„æœŸæœ›ä¸€è‡´ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ•°æ®è§£æé”™è¯¯æˆ–å´©æºƒã€‚
* **åœ¨ RPC è°ƒç”¨ä¸­ä¼ é€’æ— æ³•åºåˆ—åŒ–çš„æ•°æ®:**  é€šè¿‡ `rpc.exports` æš´éœ²çš„å‡½æ•°å¦‚æœè¿”å›æˆ–æ¥æ”¶æ— æ³•è¢« JSON åºåˆ—åŒ–çš„æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚ï¼Œå¾ªç¯å¼•ç”¨çš„å¯¹è±¡ï¼‰ï¼Œä¼šå¯¼è‡´é€šä¿¡å¤±è´¥ã€‚

**ç”¨æˆ·æ“ä½œæ˜¯å¦‚ä½•ä¸€æ­¥æ­¥çš„åˆ°è¾¾è¿™é‡Œï¼Œä½œä¸ºè°ƒè¯•çº¿ç´¢:**

1. **ç”¨æˆ·å¯åŠ¨ Frida:** ç”¨æˆ·è¿è¡Œ Frida å‘½ä»¤è¡Œå·¥å…· (ä¾‹å¦‚ï¼Œ`frida -p <pid> -l script.js`) æˆ–ä½¿ç”¨ Frida çš„ç¼–ç¨‹æ¥å£ã€‚
2. **Frida Agent åŠ è½½:** Frida Agent è¢«æ³¨å…¥åˆ°ç›®æ ‡è¿›ç¨‹ä¸­ã€‚
3. **JavaScript ä»£ç åŠ è½½å’Œæ‰§è¡Œ:** Frida Agent åŠ è½½ç”¨æˆ·æä¾›çš„ JavaScript ä»£ç  (`script.js`)ã€‚
4. **`script-runtime.js` åˆå§‹åŒ–:**  `script-runtime.js` æ˜¯ Frida Agent çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨ JavaScript ä»£ç æ‰§è¡Œä¹‹å‰ä¼šè¢«åˆå§‹åŒ–ï¼Œè®¾ç½®è¿è¡Œç¯å¢ƒï¼Œå¹¶æä¾›å¿…è¦çš„ APIã€‚
5. **ç”¨æˆ·è„šæœ¬è°ƒç”¨ Frida API:**  ç”¨æˆ·ç¼–å†™çš„ JavaScript ä»£ç è°ƒç”¨äº† `NativePointer`, `NativeFunction`, `send`, `console.log` ç­‰ Frida æä¾›çš„ APIã€‚
6. **`script-runtime.js` å¤„ç† API è°ƒç”¨:**  è¿™äº› API è°ƒç”¨æœ€ç»ˆä¼šåœ¨ `script-runtime.js` ä¸­æ‰¾åˆ°å¯¹åº”çš„å®ç°ï¼Œä¾‹å¦‚åˆ›å»º `NativePointer` å¯¹è±¡ï¼Œè°ƒç”¨ç›®æ ‡è¿›ç¨‹å‡½æ•°ï¼Œæˆ–å‘é€æ¶ˆæ¯ç»™ Frida Agentã€‚
7. **æ¶ˆæ¯ä¼ é€’å’Œäº‹ä»¶å¾ªç¯:**  å¦‚æœç”¨æˆ·è„šæœ¬ä½¿ç”¨äº† `send` æˆ– `recv`ï¼Œ`MessageDispatcher` ä¼šå¤„ç†æ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·åœ¨ `script.js` ä¸­ç¼–å†™äº† `console.log("Hello from Frida!");`ï¼Œé‚£ä¹ˆæ‰§è¡Œæµç¨‹ä¼šæ˜¯ï¼š

1. ç”¨æˆ·å¯åŠ¨ Fridaã€‚
2. Frida Agent åŠ è½½å¹¶åˆå§‹åŒ– `script-runtime.js`ã€‚
3. Frida Agent æ‰§è¡Œ `console.log("Hello from Frida!");`ã€‚
4. `console.log` çš„è°ƒç”¨è¢« `script-runtime.js` ä¸­çš„ `console` å¯¹è±¡å¤„ç†ã€‚
5. `console` å¯¹è±¡å†…éƒ¨ä¼šä½¿ç”¨ `MessageDispatcher` å°†æ—¥å¿—æ¶ˆæ¯å‘é€å› Frida å®¢æˆ·ç«¯ã€‚

**ç¬¬1éƒ¨åˆ†åŠŸèƒ½å½’çº³:**

`script-runtime.js` çš„ä¸»è¦åŠŸèƒ½æ˜¯ä¸º Frida æä¾›çš„ JavaScript è„šæœ¬æä¾›ä¸€ä¸ªåŸºç¡€çš„è¿è¡Œæ—¶ç¯å¢ƒï¼Œä½¿å…¶èƒ½å¤Ÿä¸ç›®æ ‡è¿›ç¨‹è¿›è¡Œäº¤äº’ã€‚å®ƒè´Ÿè´£åˆå§‹åŒ– JavaScript ç¯å¢ƒï¼Œæä¾›æ ¸å¿ƒ API (ä¾‹å¦‚ï¼Œå†…å­˜æ“ä½œã€å‡½æ•°è°ƒç”¨ã€æ¨¡å—è®¿é—®)ï¼Œå¹¶ç®¡ç†ä¸ Frida Agent ä¹‹é—´çš„é€šä¿¡ã€‚å®ƒå°è£…äº†åº•å±‚çš„å†…å­˜å’Œè¿›ç¨‹æ“ä½œï¼Œä½¿å¾— JavaScript å¼€å‘è€…å¯ä»¥ä½¿ç”¨æ›´é«˜çº§çš„æŠ½è±¡æ¥å®ŒæˆåŠ¨æ€ instrumentation ä»»åŠ¡ã€‚

Prompt: 
```
è¿™æ˜¯ç›®å½•ä¸ºfrida/build/subprojects/frida-core/src/barebone/script-runtime.js.p/script-runtime.jsçš„frida Dynamic instrumentation toolçš„æºä»£ç æ–‡ä»¶ï¼Œ è¯·åˆ—ä¸¾ä¸€ä¸‹å®ƒçš„åŠŸèƒ½, 
å¦‚æœæ¶‰åŠåˆ°äºŒè¿›åˆ¶åº•å±‚ï¼Œlinuxå†…æ ¸ï¼Œè¯·åšå‡ºå¯¹åº”çš„ä¸¾ä¾‹è¯´æ˜ï¼Œ
è¯·ç»™å‡ºç”¨lldbæŒ‡ä»¤æˆ–è€…lldb pythonè„šæœ¬ï¼Œç”¨æ¥å¤åˆ»çš„æºä»£ç æ‰€å®ç°è°ƒè¯•åŠŸèƒ½çš„ç¤ºä¾‹ï¼Œå¦‚æœæºä»£ç æ˜¯è°ƒè¯•åŠŸèƒ½çš„å®ç°ã€‚
å¦‚æœåšäº†é€»è¾‘æ¨ç†ï¼Œè¯·ç»™å‡ºå‡è®¾è¾“å…¥ä¸è¾“å‡º,
å¦‚æœæ¶‰åŠç”¨æˆ·æˆ–è€…ç¼–ç¨‹å¸¸è§çš„ä½¿ç”¨é”™è¯¯ï¼Œè¯·ä¸¾ä¾‹è¯´æ˜,
è¯´æ˜ç”¨æˆ·æ“ä½œæ˜¯å¦‚ä½•ä¸€æ­¥æ­¥çš„åˆ°è¾¾è¿™é‡Œï¼Œä½œä¸ºè°ƒè¯•çº¿ç´¢ï¼Œ
è¯·ç”¨ä¸­æ–‡å›å¤ã€‚
è¿™æ˜¯ç¬¬1éƒ¨åˆ†ï¼Œå…±2éƒ¨åˆ†ï¼Œè¯·å½’çº³ä¸€ä¸‹å®ƒçš„åŠŸèƒ½

"""
ğŸ“¦
5808 /script-runtime/entrypoint.js.map
4457 /script-runtime/entrypoint.js
1290 /script-runtime/console.js.map
978 /script-runtime/console.js
208 /script-runtime/gdb.js.map
22 /script-runtime/gdb.js
2528 /script-runtime/hexdump.js.map
1131 /script-runtime/hexdump.js
3199 /script-runtime/message-dispatcher.js.map
2395 /script-runtime/message-dispatcher.js
6590 /script-runtime/primitives.js.map
4287 /script-runtime/primitives.js
âœ„
{"version":3,"file":"entrypoint.js","names":["Console","hexdump","MessageDispatcher","BNativePointer","BInt64","BUInt64","messageDispatcher","Error","prepareStackTrace","error","stack","toString","Object","defineProperties","globalThis","global","enumerable","value","$rt","dispatchException","e","message","type","description","undefined","fileName","lineNumber","columnNumber","_send","JSON","stringify","dispatchMessage","json","data","parse","dispatch","rpc","exports","recv","callback","arguments","length","subscribe","send","payload","ptr","v","NULL","NativePointer","int64","Int64","uint64","UInt64","NativeFunction","Function","constructor","address","retType","argTypes","super","_NativeFunction_retType","set","this","_NativeFunction_argTypes","handle","__classPrivateFieldSet","getMarshalerFor","map","Proxy","apply","target","thiz","args","_invoke","nativeArgs","i","__classPrivateFieldGet","toNative","nativeRetval","$v","fromNative","NativeCallback","func","retTypeMarshaler","argTypeMarshalers","code","Memory","alloc","Process","pageSize","_NativeCallback_func","_NativeCallback_retType","_NativeCallback_argTypes","_NativeCallback_code","_installNativeCallback","returnAddress","context","ic","threadId","depth","errno","jsArgs","jsRetval","call","Module","findExportByName","moduleName","exportName","getExportByName","ObjC","available","Swift","Java","console","Script","runtime","setGlobalAccessHandler","handler","id","platform","codeSigningPolicy","isDebuggerAttached","enumerateModules","name","base","size","path","enumerateImports","enumerateExports","enumerateSymbols","enumerateRanges","setExceptionHandler","marshalers","pointer","int","Number","BigInt","t","m"],"sourceRoot":"/root/frida/build/subprojects/frida-core/src/barebone/script-runtime.js.p/script-runtime/","sources":["entrypoint.ts"],"mappings":"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"}
âœ„
var e,t,r,a,n,i,o=this&&this.__classPrivateFieldSet||function(e,t,r,a,n){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?n.call(e,r):n?n.value=r:t.set(e,r),r},l=this&&this.__classPrivateFieldGet||function(e,t,r,a){if("a"===r&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)};import{Console as s}from"./console.js";import{hexdump as u}from"./hexdump.js";import{MessageDispatcher as c}from"./message-dispatcher.js";import{BNativePointer as m,BInt64 as p,BUInt64 as v}from"./primitives.js";const f=new c;Error.prepareStackTrace=(e,t)=>e.toString()+"\n"+t;e=new WeakMap,t=new WeakMap;r=new WeakMap,a=new WeakMap,n=new WeakMap,i=new WeakMap,Object.defineProperties(globalThis,{global:{enumerable:!1,value:globalThis},$rt:{enumerable:!1,value:new class{dispatchException(e){const t={type:"error",description:""+e};if("object"==typeof e){const r=e.stack;void 0!==r&&(t.stack=r);const a=e.fileName;void 0!==a&&(t.fileName=a);const n=e.lineNumber;void 0!==n&&(t.lineNumber=n,t.columnNumber=1)}_send(JSON.stringify(t),null)}dispatchMessage(e,t){const r=JSON.parse(e);f.dispatch(r,t)}}},rpc:{enumerable:!0,value:{exports:{}}},recv:{enumerable:!0,value(){let e,t;return 1===arguments.length?(e="*",t=arguments[0]):(e=arguments[0],t=arguments[1]),f.subscribe(e,t)}},send:{enumerable:!0,value(e,t=null){const r={type:"send",payload:e};_send(JSON.stringify(r),t)}},ptr:{enumerable:!0,value:e=>new m(e)},NULL:{enumerable:!0,value:new m("0")},NativePointer:{enumerable:!0,value:m},int64:{enumerable:!0,value:e=>new p(e)},Int64:{enumerable:!0,value:p},uint64:{enumerable:!0,value:e=>new v(e)},UInt64:{enumerable:!0,value:v},NativeFunction:{enumerable:!0,value:class extends Function{constructor(r,a,n){return super(),e.set(this,void 0),t.set(this,void 0),this.handle=r,o(this,e,b(a),"f"),o(this,t,n.map(b),"f"),new Proxy(this,{apply:(e,t,r)=>e._invoke(r)})}_invoke(r){const a=r.map(((e,r)=>l(this,t,"f")[r].toNative(e))),n=_invoke(this.handle.$v,...a);return l(this,e,"f").fromNative(n)}}},NativeCallback:{enumerable:!0,value:class extends m{constructor(e,t,l){const s=b(t),u=l.map(b),c=Memory.alloc(Process.pageSize);super(c),r.set(this,void 0),a.set(this,void 0),n.set(this,void 0),i.set(this,void 0),o(this,r,e,"f"),o(this,a,s,"f"),o(this,n,u,"f"),o(this,i,c,"f"),_installNativeCallback(c.$v,this,l.length)}_invoke(e,t,i){const o={returnAddress:t,context:i,threadId:-1,depth:0,errno:-1},s=e.map(((e,t)=>l(this,n,"f")[t].fromNative(e))),u=l(this,r,"f").call(o,...s);return l(this,a,"f").toNative(u)}}},Module:{enumerable:!0,value:{findExportByName:(e,t)=>null,getExportByName(e,t){throw new Error(`unable to find export '${t}'`)}}},ObjC:{enumerable:!0,value:{available:!1}},Swift:{enumerable:!0,value:{available:!1}},Java:{enumerable:!0,value:{available:!1}},console:{enumerable:!0,value:new s},hexdump:{enumerable:!0,value:u}}),Object.defineProperties(Script,{runtime:{enumerable:!0,value:"QJS"},setGlobalAccessHandler:{enumerable:!0,value(e){}}}),Object.defineProperties(Process,{id:{enumerable:!0,value:0},platform:{enumerable:!0,value:"barebone"},codeSigningPolicy:{enumerable:!0,value:"optional"},isDebuggerAttached:{enumerable:!0,value:()=>!0},enumerateModules:{enumerable:!0,value:()=>[{name:"kernel",base:NULL,size:4096,path:"/kernel",enumerateImports:()=>[],enumerateExports:()=>[],enumerateSymbols:()=>[],enumerateRanges:()=>[],findExportByName:()=>null,getExportByName(e){throw new Error(`unable to find export '${e}'`)}}]},setExceptionHandler:{enumerable:!0,value(e){}}});const d={pointer:{fromNative:e=>new m(e),toNative(e){if("object"!=typeof e||null===e)throw new Error("expected a pointer");if(e instanceof m)return e.$v;const t=e.handle;if(void 0===t||!(t instanceof m))throw new Error("expected a pointer");return t.$v}},int:{fromNative:e=>Number(0n!==(0x80000000n&e)?-(0xffffffffn-e+1n):e),toNative(e){if("number"!=typeof e)throw new Error("expected an integer");return BigInt(e)}}};function b(e){const t=d[e];if(void 0===t)throw new Error(`Type ${e} is not yet supported`);return t}
âœ„
{"version":3,"file":"console.js","names":["hexdump","Console","constructor","_Console_counters","set","this","Map","info","args","sendLogMessage","log","debug","warn","error","count","label","newValue","__classPrivateFieldGet","get","countReset","has","delete","level","values","message","type","payload","map","parseLogArgument","join","_send","JSON","stringify","value","ArrayBuffer","undefined"],"sourceRoot":"/root/frida/build/subprojects/frida-core/src/barebone/script-runtime.js.p/script-runtime/","sources":["console.ts"],"mappings":"qWAASA,MAAe,sBAElB,MAAOC,QAAbC,cACIC,EAAAC,IAAAC,KAAY,IAAIC,IAmCpB,CAjCIC,QAAQC,GACJC,EAAe,OAAQD,EAC3B,CAEAE,OAAOF,GACHC,EAAe,OAAQD,EAC3B,CAEAG,SAASH,GACLC,EAAe,QAASD,EAC5B,CAEAI,QAAQJ,GACJC,EAAe,UAAWD,EAC9B,CAEAK,SAASL,GACLC,EAAe,QAASD,EAC5B,CAEAM,MAAMC,EAAQ,WACV,MAAMC,GAAYC,EAAAZ,KAAIF,EAAA,KAAWe,IAAIH,IAAU,GAAK,EACpDE,EAAAZ,KAAIF,EAAA,KAAWC,IAAIW,EAAOC,GAC1BX,KAAKK,IAAI,GAAGK,MAAUC,IAC1B,CAEAG,WAAWJ,EAAQ,WACXE,EAAAZ,KAAIF,EAAA,KAAWiB,IAAIL,GACnBE,EAAAZ,KAAIF,EAAA,KAAWkB,OAAON,GAEtBV,KAAKO,KAAK,cAAcG,oBAEhC,EAKJ,SAASN,EAAea,EAAiBC,GACrC,MACMC,EAAU,CACZC,KAAM,MACNH,MAAOA,EACPI,QAJSH,EAAOI,IAAIC,GAAkBC,KAAK,MAM/CC,MAAMC,KAAKC,UAAUR,GAAU,KACnC,CAEA,SAASI,EAAiBK,GACtB,OAAIA,aAAiBC,YACVlC,EAAQiC,QAELE,IAAVF,EACO,YAEG,OAAVA,EACO,OAEJA,CACX,C"}
âœ„
var e,t=this&&this.__classPrivateFieldGet||function(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)};import{hexdump as n}from"./hexdump.js";export class Console{constructor(){e.set(this,new Map)}info(...e){o("info",e)}log(...e){o("info",e)}debug(...e){o("debug",e)}warn(...e){o("warning",e)}error(...e){o("error",e)}count(n="default"){const o=(t(this,e,"f").get(n)??0)+1;t(this,e,"f").set(n,o),this.log(`${n}: ${o}`)}countReset(n="default"){t(this,e,"f").has(n)?t(this,e,"f").delete(n):this.warn(`Count for "${n}" does not exist`)}}function o(e,t){const n={type:"log",level:e,payload:t.map(r).join(" ")};_send(JSON.stringify(n),null)}function r(e){return e instanceof ArrayBuffer?n(e):void 0===e?"undefined":null===e?"null":e}e=new WeakMap;
âœ„
{"version":3,"file":"gdb.js","names":["gdb","$gdb"],"sourceRoot":"/root/frida/build/subprojects/frida-core/src/barebone/script-runtime.js.p/script-runtime/","sources":["gdb.ts"],"mappings":"OAEO,MAAMA,IAAMC"}
âœ„
export const gdb=$gdb;
âœ„
{"version":3,"file":"hexdump.js","names":["hexdump","target","options","buffer","defaultStartAddress","NULL","length","ArrayBuffer","undefined","byteLength","Math","min","NativePointer","handle","readByteArray","address","startAddress","offset","startOffset","header","showHeader","ansi","useAnsi","endAddress","add","bytes","Uint8Array","columnPadding","leftColumnWidth","max","toString","resetColor","offsetColor","dataColor","newlineColor","result","push","pad","bufferOffset","asciiChars","lineSize","lineOffset","value","isNewline","hexPair","String","fromCharCode","Array","prototype","apply","trailingSpaceCount","tailOffset","slice","join","str","width","fill","paddingSize","index"],"sourceRoot":"/root/frida/build/subprojects/frida-core/src/barebone/script-runtime.js.p/script-runtime/","sources":["hexdump.ts"],"mappings":"OAAM,SAAUA,QAAQC,EAA0CC,EAA0B,IACxF,IAAIC,EACAC,EAAsBC,KACtBC,EAASJ,EAAQI,OACjBL,aAAkBM,aAEdD,OADWE,IAAXF,EACSL,EAAOQ,WAEPC,KAAKC,IAAIL,EAAQL,EAAOQ,YACrCN,EAASF,IAEHA,aAAkBW,gBACpBX,EAASA,EAAOY,aACLL,IAAXF,IACAA,EAAS,KACbH,EAASF,EAAOa,cAAcR,GAC9BF,EAAsBH,GAG1B,MACIc,QAASC,EAAeZ,EACxBa,OAAQC,EAAc,EACtBC,OAAQC,GAAa,EACrBC,KAAMC,GAAU,GAChBpB,EACEqB,EAAaP,EAAaQ,IAAIlB,GAE9BmB,EAAQ,IAAIC,WAAWvB,GAEvBwB,EAAgB,KAChBC,EAAkBlB,KAAKmB,IAAIN,EAAWO,SAAS,IAAIxB,OAAQ,GAIjE,IAAIyB,EAAYC,EAAaC,EAAWC,EACpCZ,GACAS,EAAa,OACbC,EAAc,UACdC,EAAY,UACZC,EAAeH,IAEfA,EAAa,GACbC,EAAc,GACdC,EAAY,GACZC,EAAe,IAGnB,MAAMC,EAAmB,GAErBf,GACAe,EAAOC,KACHC,EAAI,WAAYT,EAAiB,KACjCD,EArBU,kDAuBVA,EAtBY,mBAwBZ,MAIR,IAAIV,EAASC,EACb,IAAK,IAAIoB,EAAe,EAAGA,EAAehC,EAAQgC,GAAgB,GAAI,CAC7C,IAAjBA,GACAH,EAAOC,KAAK,MAEhBD,EAAOC,KACHJ,EAAaK,EAAIrB,EAAaQ,IAAIP,GAAQa,SAAS,IAAKF,EAAiB,KAAMG,EAC/EJ,GAGJ,MAAMY,EAAuB,GACvBC,EAAW9B,KAAKC,IAAIL,EAASW,EAAQ,IAE3C,IAAK,IAAIwB,EAAa,EAAGA,IAAeD,EAAUC,IAAc,CAC5D,MAAMC,EAAQjB,EAAMR,KAEd0B,EAAsB,KAAVD,EAEZE,EAAUP,EAAIK,EAAMZ,SAAS,IAAK,EAAG,KACxB,IAAfW,GACAN,EAAOC,KAAK,KAChBD,EAAOC,KACHO,EAAYT,EAAeD,EAC3BW,EACAb,GAGJQ,EAAWH,KACPO,EAAYT,EAAeD,EAC1BS,GAAS,IAAMA,GAAS,IAAOG,OAAOC,aAAaJ,GAAS,IAC7DX,E,CAIR,IAAK,IAAIU,EAAaD,EAAyB,KAAfC,EAAmBA,IAC/CN,EAAOC,KAAK,OACZG,EAAWH,KAAK,KAGpBD,EAAOC,KAAKT,GAEZoB,MAAMC,UAAUZ,KAAKa,MAAMd,EAAQI,E,CAGvC,IAAIW,EAAqB,EACzB,IAAK,IAAIC,EAAahB,EAAO7B,OAAS,EAAG6C,GAAc,GAA4B,MAAvBhB,EAAOgB,GAAqBA,IACpFD,IAGJ,OAAOf,EAAOiB,MAAM,EAAGjB,EAAO7B,OAAS4C,GAAoBG,KAAK,GACpE,CAEA,SAAShB,EAAIiB,EAAaC,EAAeC,GACrC,MAAMrB,EAAmB,GACnBsB,EAAc/C,KAAKmB,IAAI0B,EAAQD,EAAIhD,OAAQ,GACjD,IAAK,IAAIoD,EAAQ,EAAGA,IAAUD,EAAaC,IACvCvB,EAAOC,KAAKoB,GAEhB,OAAOrB,EAAOkB,KAAK,IAAMC,CAC7B"}
âœ„
export function hexdump(e,n={}){let r,o=NULL,h=n.length;e instanceof ArrayBuffer?(h=void 0===h?e.byteLength:Math.min(h,e.byteLength),r=e):(e instanceof NativePointer||(e=e.handle),void 0===h&&(h=256),r=e.readByteArray(h),o=e);const{address:s=o,offset:a=0,header:i=!0,ansi:l=!1}=n,p=s.add(h),u=new Uint8Array(r),f="  ",d=Math.max(p.toString(16).length,8);let g,c,m,y;l?(g="[0m",c="[0;32m",m="[0;33m",y=g):(g="",c="",m="",y="");const A=[];i&&A.push(t("        ",d," "),f," 0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F",f,"0123456789ABCDEF","\n");let x=a;for(let e=0;e<h;e+=16){0!==e&&A.push("\n"),A.push(c,t(s.add(x).toString(16),d,"0"),g,f);const n=[],r=Math.min(h-x,16);for(let e=0;e!==r;e++){const r=u[x++],o=10===r,h=t(r.toString(16),2,"0");0!==e&&A.push(" "),A.push(o?y:m,h,g),n.push(o?y:m,r>=32&&r<=126?String.fromCharCode(r):".",g)}for(let t=r;16!==t;t++)A.push("   "),n.push(" ");A.push(f),Array.prototype.push.apply(A,n)}let B=0;for(let t=A.length-1;t>=0&&" "===A[t];t--)B++;return A.slice(0,A.length-B).join("")}function t(t,e,n){const r=[],o=Math.max(e-t.length,0);for(let t=0;t!==o;t++)r.push(n);return r.join("")+t}
âœ„
{"version":3,"file":"message-dispatcher.js","names":["MessageDispatcher","constructor","_MessageDispatcher_messages","set","this","_MessageDispatcher_operations","Map","_MessageDispatcher_dispatch","item","message","data","ops","__classPrivateFieldGet","opsForType","handlerType","type","undefined","get","push","complete","shift","length","delete","dispatch","Array","_MessageDispatcher_instances","_MessageDispatcher_handleRpcMessage","call","slice","_MessageDispatcher_dispatchMessages","subscribe","handler","op","MessageRecvOperation","id","operation","params","exports","rpc","method","args","hasOwnProperty","_MessageDispatcher_reply","result","apply","then","value","catch","error","name","stack","e","Object","keys","ArrayBuffer","send","concat","splice","forEach","_MessageRecvOperation_completed","wait","_waitForEvent","_complete","__classPrivateFieldSet"],"sourceRoot":"/root/frida/build/subprojects/frida-core/src/barebone/script-runtime.js.p/script-runtime/","sources":["message-dispatcher.ts"],"mappings":"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"}
âœ„
var t,e,s,i,a,r,o,n,c=this&&this.__classPrivateFieldGet||function(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)},h=this&&this.__classPrivateFieldSet||function(t,e,s,i,a){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?a.call(t,s):a?a.value=s:e.set(t,s),s};export class MessageDispatcher{constructor(){t.add(this),e.set(this,[]),s.set(this,new Map),o.set(this,(t=>{const[i,a]=t,r=c(this,s,"f");let o,n=i.type;if(void 0!==n&&(o=r.get(n)),void 0===o&&(n="*",o=r.get(n)),void 0===o)return void c(this,e,"f").push(t);const h=o.shift();0===o.length&&r.delete(n),h(i,a)}))}dispatch(s,a){s instanceof Array&&"frida:rpc"===s[0]?c(this,t,"m",i).call(this,s[1],s[2],s.slice(3)):(c(this,e,"f").push([s,a]),c(this,t,"m",r).call(this))}subscribe(e,i){const a=new MessageRecvOperation(i),o=c(this,s,"f");let n=o.get(e);return void 0===n&&(n=[],o.set(e,n)),n.push(a.handler),c(this,t,"m",r).call(this),a}}e=new WeakMap,s=new WeakMap,o=new WeakMap,t=new WeakSet,i=function(e,s,i){const r=rpc.exports;if("call"===s){const s=i[0],o=i[1];if(!r.hasOwnProperty(s))return void c(this,t,"m",a).call(this,e,"error",`unable to find method "${s}"`);try{const i=r[s].apply(r,o);"object"==typeof i&&null!==i&&"function"==typeof i.then?i.then((s=>{c(this,t,"m",a).call(this,e,"ok",s)})).catch((s=>{c(this,t,"m",a).call(this,e,"error",s.message,[s.name,s.stack,s])})):c(this,t,"m",a).call(this,e,"ok",i)}catch(s){c(this,t,"m",a).call(this,e,"error",s.message,[s.name,s.stack,s])}}else"list"===s&&c(this,t,"m",a).call(this,e,"ok",Object.keys(r))},a=function(t,e,s,i=[]){s instanceof ArrayBuffer?send(["frida:rpc",t,e,{}].concat(i),s):send(["frida:rpc",t,e,s].concat(i))},r=function(){c(this,e,"f").splice(0).forEach(c(this,o,"f"))};export class MessageRecvOperation{constructor(t){n.set(this,!1),this.handler=t}wait(){for(;!c(this,n,"f");)_waitForEvent()}_complete(t,e){try{this.handler(t,e)}finally{h(this,n,!0,"f")}}}n=new WeakMap;
âœ„
{"version":3,"file":"primitives.js","names":["gdb","u64Max","ptrSize","BigInt","Process","pointerSize","ptrMax","signBitMask","longIsSixtyFourBitsWide","BNativePointer","constructor","v","this","$v","handle","val","add","rhs","parseBigInt","sub","and","or","xor","shr","shl","not","sign","strip","blend","compare","rawRhs","lhs","equals","toInt32","Number","toUInt32","toString","radix","undefined","toJSON","toMatchPattern","throwNotImplemented","readPointer","writePointer","value","readS8","writeS8","readU8","writeU8","readS16","writeS16","readU16","writeU16","readS32","writeS32","readU32","writeU32","readS64","writeS64","readU64","writeU64","readShort","writeShort","readUShort","writeUShort","readInt","writeInt","readUInt","writeUInt","readLong","writeLong","readULong","writeULong","readFloat","writeFloat","readDouble","writeDouble","readByteArray","length","writeByteArray","readCString","size","readUtf8String","writeUtf8String","readUtf16String","writeUtf16String","readAnsiString","writeAnsiString","BInt64","toNumber","valueOf","BUInt64","Error"],"sourceRoot":"/root/frida/build/subprojects/frida-core/src/barebone/script-runtime.js.p/script-runtime/","sources":["primitives.ts"],"mappings":"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"}
âœ„
import{gdb as t}from"./gdb.js";const r=0xffffffffffffffffn,e=BigInt(Process.pointerSize),n=8n===e?r:0xffffffffn,i=1n<<8n*e-1n,s=8n===e;export class BNativePointer{constructor(t){if("object"==typeof t)this.$v="$v"in t?t.$v:t.handle.$v;else{let r=BigInt(t);r<0n&&(r=n-(-r-1n)),this.$v=r}}add(t){return new BNativePointer(this.$v+h(t))}sub(t){return new BNativePointer(this.$v-h(t))}and(t){return new BNativePointer(this.$v&h(t))}or(t){return new BNativePointer(this.$v|h(t))}xor(t){return new BNativePointer(this.$v^h(t))}shr(t){return new BNativePointer(this.$v>>h(t))}shl(t){return new BNativePointer(this.$v<<h(t))}not(){return new BNativePointer(~this.$v)}sign(){return this}strip(){return this}blend(){return this}compare(t){const r=this.$v,e=h(t);return r===e?0:r<e?-1:1}equals(t){return 0===this.compare(t)}toInt32(){const t=this.$v;return Number(0n!==(t&i)?-(n-t+1n):t)}toUInt32(){return Number(this.$v)}toString(t){return void 0===t?"0x"+this.$v.toString(16):this.$v.toString(t)}toJSON(){return"0x"+this.$v.toString(16)}toMatchPattern(){u()}readPointer(){return t.readPointer(this.$v)}writePointer(r){return t.writePointer(this.$v,r),this}readS8(){return t.readS8(this.$v)}writeS8(r){return t.writeS8(this.$v,r),this}readU8(){return t.readU8(this.$v)}writeU8(r){return t.writeU8(this.$v,r),this}readS16(){return t.readS16(this.$v)}writeS16(r){return t.writeS16(this.$v,r),this}readU16(){return t.readU16(this.$v)}writeU16(r){return t.writeU16(this.$v,r),this}readS32(){return t.readS32(this.$v)}writeS32(r){return t.writeS32(this.$v,r),this}readU32(){return t.readU32(this.$v)}writeU32(r){return t.writeU32(this.$v,r),this}readS64(){return t.readS64(this.$v)}writeS64(r){return t.writeS64(this.$v,r),this}readU64(){return t.readU64(this.$v)}writeU64(r){return t.writeU64(this.$v,r),this}readShort(){return this.readS16()}writeShort(t){return this.writeS16(t)}readUShort(){return this.readU16()}writeUShort(t){return this.writeU16(t)}readInt(){return this.readS32()}writeInt(t){return this.writeS32(t)}readUInt(){return this.readU32()}writeUInt(t){return this.writeU32(t)}readLong(){return s?this.readS64():this.readS32()}writeLong(t){return s?this.writeS64(t):this.writeS32(t)}readULong(){return s?this.readU64():this.readU32()}writeULong(t){return s?this.writeU64(t):this.writeU32(t)}readFloat(){return t.readFloat(this.$v)}writeFloat(r){return t.writeFloat(this.$v,r),this}readDouble(){return t.readDouble(this.$v)}writeDouble(r){return t.writeDouble(this.$v,r),this}readByteArray(r){return t.readByteArray(this.$v,r)}writeByteArray(r){return t.writeByteArray(this.$v,r),this}readCString(r){return t.readCString(this.$v,r)}readUtf8String(r){return t.readUtf8String(this.$v,r)}writeUtf8String(r){return t.writeUtf8String(this.$v,r),this}readUtf16String(t){u()}writeUtf16String(t){u()}readAnsiString(t){u()}writeAnsiString(t){u()}}export class BInt64{constructor(t){this.$v="object"==typeof t?t.$v:BigInt(t)}add(t){return new BInt64(this.$v+h(t))}sub(t){return new BInt64(this.$v-h(t))}and(t){return new BInt64(this.$v&h(t))}or(t){return new BInt64(this.$v|h(t))}xor(t){return new BInt64(this.$v^h(t))}shr(t){return new BInt64(this.$v>>h(t))}shl(t){return new BInt64(this.$v<<h(t))}not(){return new BInt64(~this.$v)}compare(t){const r=this.$v,e=h(t);return r===e?0:r<e?-1:1}equals(t){return 0===this.compare(t)}toNumber(){return Number(this.$v)}toString(t){return this.$v.toString(t)}toJSON(){return this.$v.toString()}valueOf(){return Number(this.$v)}}export class BUInt64{constructor(t){if("object"==typeof t)this.$v=t.$v;else{let e=BigInt(t);e<0n&&(e=r-(-e-1n)),this.$v=e}}add(t){return new BUInt64(this.$v+h(t))}sub(t){return new BUInt64(this.$v-h(t))}and(t){return new BUInt64(this.$
"""


```