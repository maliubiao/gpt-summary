Response:
The user wants to understand the functionality of the `fs_agent.js` file, which is part of Frida's dynamic instrumentation tools. They are particularly interested in aspects related to binary operations, the Linux kernel, and how to replicate the functionality using LLDB.

Here's a plan to address the user's request:

1. **High-level overview of the code:** Briefly describe what the JavaScript code does at a conceptual level.
2. **Functionality breakdown:** List the specific functions within the code and their purpose.
3. **Binary/kernel interaction (if any):** Analyze the code for direct interactions with binary data or kernel-level operations. Explain with examples if present.
4. **LLDB replication:**  Since the code appears to be implementing hooks or tracing for file system operations, explain how LLDB can be used to achieve similar results. This will likely involve setting breakpoints at relevant system calls.
5. **Assumptions and input/output:**  If the code makes logical decisions, provide examples of inputs and expected outputs based on those decisions.
6. **Common user errors:** Identify potential pitfalls or incorrect usage patterns a user might encounter.
7. **Steps to reach the code:** Describe the user actions that would lead to the execution of this specific Frida agent.
8. **Summary of functionality:** Conclude with a concise summary of the agent's capabilities.这是一个Frida动态插桩工具的源代码文件，位于`frida/build/subprojects/frida-tools/agents/fs/fs_agent.js`。从代码结构和函数命名来看，这个agent的主要功能是 **监控和跟踪文件系统操作**。

以下是其功能的详细列举：

1. **拦截和Hook文件系统相关的JavaScript API:**
   -  代码开头定义了一些变量 `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"`. 这部分代码看起来像是在hook一些全局对象或者模块的方法，以便在这些方法被调用时执行自定义的逻辑。 例如，`cAAcH.UAAU+C.UAAY` 很可能是hook了某个全局对象的 `fs` 模块下的某个方法 (例如 `fs.open`, `fs.read`, `fs.write` 等)。

2. **详细Hook的函数和操作:**
   - 代码中定义了多个函数，如 `SAAS+B`, `SAASnE`, `SAASSe` 等，这些函数很可能对应着不同的文件系统操作。
   -  在这些函数内部，可以看到对原始函数调用的封装和增强，例如在调用原始函数前后添加额外的逻辑。
   -  代码中使用了 `KAAK+C.eAAiB(IAAIpD.cAAcC` 这样的结构，这很可能是在创建一个新的对象来存储hook的信息，例如被hook的函数、参数等。
   -  代码中也有对函数参数和返回值的处理，例如 `EAAQoD.Q`, `EAAQoD.OAEM` 等，可能是获取或修改函数参数或返回值。

3. **二进制底层和Linux内核的关联:**
   -  文件系统的操作本质上会涉及到与Linux内核的交互。当JavaScript代码调用 `fs` 模块的方法时，Node.js底层会通过系统调用与内核进行交互。
   -  Frida agent可以hook这些JavaScript API，从而在用户态截获文件系统操作的参数（如文件名、文件描述符、读写的数据等）。
   -  例如，当hook了 `fs.open` 时，可以获取到打开文件的路径、打开模式等信息，这些信息直接对应着系统调用 `open` 的参数。
   -  当hook了 `fs.read` 或 `fs.write` 时，可以获取到读写的文件描述符和数据缓冲区，这些都与底层的 `read` 和 `write` 系统调用紧密相关。
   -  代码中并没有直接操作二进制数据或内核数据结构的迹象，但其监控的文件系统操作会直接反映底层的二进制数据读写。

4. **使用LLDB指令或Python脚本复刻调试功能示例:**

   由于 `fs_agent.js` 是一个用于监控文件系统操作的工具，我们可以在 LLDB 中通过断点来达到类似的效果，即在相关的系统调用入口处设置断点，查看参数信息。

   **LLDB 指令示例 (假设我们想监控 `open` 系统调用):**

   ```lldb
   breakpoint set --name open
   ```

   当程序执行到 `open` 系统调用时，LLDB 会中断。我们可以使用以下指令查看参数：

   ```lldb
   frame variable
   ```

   这会显示当前栈帧的变量，其中就包含了传递给 `open` 的参数，例如文件名 (通常是一个字符串指针)。

   **LLDB Python 脚本示例 (监控 `read` 系统调用并打印读取的字节数):**

   ```python
   def read_breakpoint_handler(debugger, command, result, internal_dict):
       frame = debugger.GetSelectedTarget().GetProcess().GetSelectedThread().GetSelectedFrame()
       fd_value = frame.FindVariable("fd").GetValueAsSigned()
       count_value = frame.FindVariable("count").GetValueAsUnsigned()
       print(f"read() called with fd: {fd_value}, count: {count_value}")

   def __lldb_init_module(debugger, internal_dict):
       debugger.HandleCommand('breakpoint set --name read --script-from-string "read_breakpoint_handler(debugger, command, result, internal_dict)"')
       print("read() breakpoint set with Python handler.")
   ```

   将以上代码保存为 `read_monitor.py`，然后在 LLDB 中使用以下命令加载并设置断点：

   ```lldb
   command script import read_monitor.py
   ```

   当程序执行到 `read` 系统调用时，Python 脚本会被执行，并打印文件描述符和读取的字节数。

5. **假设输入与输出 (逻辑推理):**

   假设 `SAASSe` 函数是用来hook `fs.open` 的，并且它的逻辑是在文件打开后打印文件名。

   **假设输入:** 用户在 Node.js 代码中调用 `fs.open('/tmp/test.txt', 'r', callback)`。

   **预期输出:** Frida agent会拦截这个调用，执行 `SAASSe` 中的逻辑，可能会在控制台输出类似 `文件 '/tmp/test.txt' 被打开了` 的信息，然后才会调用原始的 `fs.open` 并执行回调函数。

6. **用户或编程常见的使用错误:**

   - **Hook错误的API:** 用户可能会尝试hook不存在的文件系统API，导致agent无法正常工作。
   - **参数理解错误:** 用户在hook函数中处理参数时，可能会对参数的类型或含义理解错误，导致处理逻辑出错。例如，将文件描述符误认为文件名。
   - **异步处理不当:** 文件系统操作通常是异步的，用户在hook函数中进行异步操作时，需要正确处理回调，否则可能会导致
Prompt: 
```
这是目录为frida/build/subprojects/frida-tools/agents/fs/fs_agent.js的frida Dynamic instrumentation tool的源代码文件， 请列举一下它的功能, 
如果涉及到二进制底层，linux内核，请做出对应的举例说明，
请给出用lldb指令或者lldb python脚本，用来复刻的源代码所实现调试功能的示例，如果源代码是调试功能的实现。
如果做了逻辑推理，请给出假设输入与输出,
如果涉及用户或者编程常见的使用错误，请举例说明,
说明用户操作是如何一步步的到达这里，作为调试线索，
请用中文回复。
这是第9部分，共12部分，请归纳一下它的功能

"""
gC,QAAS,EAIdhC,KAAKiC,cAAe,EAEpBjC,KAAKP,GAAe,EACtB,CAEA,SAAS+B,EAAYU,GACnBA,EAAMC,SAAW,GACjBD,EAAME,cAAgB,EACtBF,EAAMG,YAAa,EACnBH,EAAMI,SAAU,CAClB,CAEA3C,cAAcH,UAAU+C,UAAY,WAClC,OAAOvC,KAAKmC,SAASK,MAAMxC,KAAKoC,cAClC,EAEA9C,OAAOmD,eAAe9C,cAAcH,UAAW,uBAAwB,CACrEkD,MACE,OAAO1C,KAAKmC,SAAStB,OAASb,KAAKoC,aACrC,IAGF,MAAMO,EAAkBC,SAASpD,UAAUE,OAAOmD,oBAE3C,SAASnE,SAASkB,GAWvB,MAAME,EAAYE,gBAAgB5B,EAAO2B,OAEzC,IAAKD,IAAa6C,EAAgBG,KAAKpE,SAAUsB,MAC/C,OAAO,IAAItB,SAASkB,GAEtBI,KAAK+C,eAAiB,IAAIpD,cAAcC,EAASI,KAAMF,GAEnDF,IAC2B,mBAAlBA,EAAQoD,QACjBhD,KAAKiD,OAASrD,EAAQoD,OAEM,mBAAnBpD,EAAQsD,SACjBlD,KAAKmD,QAAUvD,EAAQsD,QAEM,mBAApBtD,EAAQwD,UACjBpD,KAAKqD,SAAWzD,EAAQwD,SAEG,mBAAlBxD,EAAQ0D,QACjBtD,KAAKuD,OAAS3D,EAAQ0D,OAES,mBAAtB1D,EAAQ4D,YACjBxD,KAAKyD,WAAa7D,EAAQ4D,WAExB5D,EAAQ8D,QACVzF,EAAe2B,EAAQ8D,OAAQ1D,OAGnC5B,EAAO0E,KAAK9C,KAAMJ,GAElB1B,EAAYsF,UAAUxD,MAAM,KAC1B,MAAMkC,EAAQlC,KAAK+C,eAEdb,EAAMpB,SACT6C,EAAY3D,KAAMkC,GAGpB0B,EAAY5D,KAAMkC,EAAM,GAE5B,CAgBA,SAASe,EAAOpD,EAAQgE,EAAOC,EAAUC,GACvC,MAAM7B,EAAQrC,EAAOkD,eAErB,GAAwB,mBAAbe,EACTC,EAAKD,EACLA,EAAW5B,EAAMtB,oBACZ,CACL,GAAKkD,GAEA,GAAiB,WAAbA,IAA0BvF,EAAOyF,WAAWF,GACnD,MAAM,IAAI3E,EAAqB2E,QAF/BA,EAAW5B,EAAMtB,gBAGD,mBAAPmD,IACTA,EAAK1E,EACT,CAEA,GAAc,OAAVwE,EACF,MAAM,IAAI5E,EACL,IAAKiD,EAAMjC,WAChB,GAAqB,iBAAV4D,GACmB,IAAxB3B,EAAMvB,gBACRkD,EAAQtF,EAAO0F,KAAKJ,EAAOC,GAC3BA,EAAW,eAER,GAAID,aAAiBtF,EAC1BuF,EAAW,aACN,KAAI1F,EAAO8F,cAAcL,GAI9B,MAAM,IAAIlF,EACR,QAAS,CAAC,SAAU,SAAU,cAAekF,GAJ/CA,EAAQzF,EAAO+F,oBAAoBN,GACnCC,EAAW,QAIb,CAGF,IAAIM,EAOJ,OANIlC,EAAM5B,OACR8D,EAAM,IAAIlF,EACDgD,EAAMzB,YACf2D,EAAM,IAAIrF,EAAqB,UAG7BqF,GACF3F,EAAQ4F,SAASN,EAAIK,GACrBhF,EAAeS,EAAQuE,GAAK,GACrBA,IAETlC,EAAMT,YAoCR,SAAuB5B,EAAQqC,EAAO2B,EAAOC,EAAUQ,GACrD,MAAMC,EAAMrC,EAAMjC,WAAa,EAAI4D,EAAMhD,OAEzCqB,EAAMrB,QAAU0D,EAGhB,MAAMC,EAAMtC,EAAMrB,OAASqB,EAAM/B,cAE5BqE,IACHtC,EAAM7B,WAAY,GAEhB6B,EAAMpB,SAAWoB,EAAMnB,QAAUmB,EAAMH,UAAYG,EAAMR,aAC3DQ,EAAMC,SAASsC,KAAK,CAAEZ,QAAOC,WAAUQ,aACnCpC,EAAMG,YAA2B,WAAbyB,IACtB5B,EAAMG,YAAa,GAEjBH,EAAMI,SAAWgC,IAAajF,IAChC6C,EAAMI,SAAU,KAGlBJ,EAAMZ,SAAWiD,EACjBrC,EAAMb,QAAUiD,EAChBpC,EAAMpB,SAAU,EAChBoB,EAAMlB,MAAO,EACbnB,EAAOoD,OAAOY,EAAOC,EAAU5B,EAAMhB,SACrCgB,EAAMlB,MAAO,GAKf,OAAOwD,IAAQtC,EAAMH,UAAYG,EAAMzB,SACzC,CAlESiE,CAAc7E,EAAQqC,EAAO2B,EAAOC,EAAUC,GACvD,CAmEA,SAASY,EAAQ9E,EAAQqC,EAAOgB,EAAQqB,EAAKV,EAAOC,EAAUC,GAC5D7B,EAAMZ,SAAWiD,EACjBrC,EAAMb,QAAU0C,EAChB7B,EAAMpB,SAAU,EAChBoB,EAAMlB,MAAO,EACTkB,EAAMzB,UACRyB,EAAMhB,QAAQ,IAAInC,EAAqB,UAChCmE,EACPrD,EAAOsD,QAAQU,EAAO3B,EAAMhB,SAE5BrB,EAAOoD,OAAOY,EAAOC,EAAU5B,EAAMhB,SACvCgB,EAAMlB,MAAO,CACf,CAEA,SAAS4D,EAAa/E,EAAQqC,EAAO2C,EAAId,KACrC7B,EAAMT,UAERsC,EAAGc,GAKHC,EAAY5C,GAEZ9C,EAAeS,EAAQgF,EACzB,CAEA,SAAS3D,EAAQrB,EAAQgF,GACvB,MAAM3C,EAAQrC,EAAOkD,eACf/B,EAAOkB,EAAMlB,KACb+C,EAAK7B,EAAMb,QAEC,mBAAP0C,GAKX7B,EAAMpB,SAAU,EAChBoB,EAAMb,QAAU,KAChBa,EAAMrB,QAAUqB,EAAMZ,SACtBY,EAAMZ,SAAW,EAEbuD,GAEFA,EAAGE,MAEE7C,EAAMH,UACTG,EAAMH,QAAU8C,GAKdhF,EAAOmF,iBAAmBnF,EAAOmF,eAAejD,UAClDlC,EAAOmF,eAAejD,QAAU8C,GAG9B7D,EACFvC,EAAQ4F,SAASO,EAAc/E,EAAQqC,EAAO2C,EAAId,GAElDa,EAAa/E,EAAQqC,EAAO2C,EAAId,KAG9B7B,EAAMC,SAAStB,OAASqB,EAAME,eAChCuB,EAAY9D,EAAQqC,GAGlBlB,EAK+B,OAA7BkB,EAAMX,oBACNW,EAAMX,mBAAmBwC,KAAOA,EAClC7B,EAAMX,mBAAmB0D,SAEzB/C,EAAMX,mBAAqB,CAAE0D,MAAO,EAAGlB,KAAIlE,SAAQqC,SACnDzD,EAAQ4F,SAASa,EAAgBhD,EAAMX,qBAGzC4D,EAAWtF,EAAQqC,EAAO,EAAG6B,KA9C/B3E,EAAeS,EAAQ,IAAIhB,EAiD/B,CAEA,SAASqG,GAAerF,OAAEA,EAAMqC,MAAEA,EAAK+C,MAAEA,EAAKlB,GAAEA,IAE9C,OADA7B,EAAMX,mBAAqB,KACpB4D,EAAWtF,EAAQqC,EAAO+C,EAAOlB,EAC1C,CAEA,SAASoB,EAAWtF,EAAQqC,EAAO+C,EAAOlB,GAQxC,KAPmB7B,EAAM5B,SAAWT,EAAOY,WAA8B,IAAjByB,EAAMrB,QAC5DqB,EAAM7B,YAEN6B,EAAM7B,WAAY,EAClBR,EAAOuF,KAAK,UAGPH,KAAU,GACf/C,EAAMT,YACNsC,IAGE7B,EAAMzB,WACRqE,EAAY5C,GAGd0B,EAAY/D,EAAQqC,EACtB,CAGA,SAAS4C,EAAY5C,GACnB,GAAIA,EAAMpB,QACR,OAGF,IAAK,IAAIuE,EAAInD,EAAME,cAAeiD,EAAInD,EAAMC,SAAStB,SAAUwE,EAAG,CAChE,MAAMxB,MAAEA,EAAKS,SAAEA,GAAapC,EAAMC,SAASkD,GACrCd,EAAMrC,EAAMjC,WAAa,EAAI4D,EAAMhD,OACzCqB,EAAMrB,QAAU0D,EAChBD,EAASpC,EAAMH,SAAW,IAAIhD,EAAqB,SACrD,CAEA,MAAMuG,EAAoBpD,EAAMzC,GAAa8F,OAAO,GACpD,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAkBzE,OAAQ2E,IAC5CF,EAAkBE,GAAGtD,EAAMH,SAAW,IAAIhD,EAAqB,QAGjEyC,EAAYU,EACd,CAGA,SAASyB,EAAY9D,EAAQqC,GAC3B,GAAIA,EAAMnB,QACNmB,EAAMjB,kBACNiB,EAAMzB,YACLyB,EAAMR,YACT,OAGF,MAAMS,SAAEA,EAAQC,cAAEA,EAAanC,WAAEA,GAAeiC,EAC1CuD,EAAiBtD,EAAStB,OAASuB,EAEzC,IAAKqD,EACH,OAGF,IAAID,EAAIpD,EAGR,GADAF,EAAMjB,kBAAmB,EACrBwE,EAAiB,GAAK5F,EAAOsD,QAAS,CACxCjB,EAAMT,WAAagE,EAAiB,EAEpC,MAAMnB,EAAWpC,EAAMI,QAAUjD,EAAO+E,IACtC,IAAK,IAAIiB,EAAIG,EAAGH,EAAIlD,EAAStB,SAAUwE,EACrClD,EAASkD,GAAGf,SAASF,EACvB,EAIIsB,EAASxD,EAAMI,SAAiB,IAANkD,EAAUrD,EAAWA,EAASK,MAAMgD,GACpEE,EAAOrD,WAAaH,EAAMG,WAE1BsC,EAAQ9E,EAAQqC,GAAO,EAAMA,EAAMrB,OAAQ6E,EAAQ,GAAIpB,GAEvD9C,EAAYU,EACd,KAAO,CACL,EAAG,CACD,MAAM2B,MAAEA,EAAKC,SAAEA,EAAQQ,SAAEA,GAAanC,EAASqD,GAC/CrD,EAASqD,KAAO,KAEhBb,EAAQ9E,EAAQqC,GAAO,EADXjC,EAAa,EAAI4D,EAAMhD,OACAgD,EAAOC,EAAUQ,EACtD,OAASkB,EAAIrD,EAAStB,SAAWqB,EAAMpB,SAEnC0E,IAAMrD,EAAStB,OACjBW,EAAYU,GACHsD,EAAI,KACbrD,EAASoD,OAAO,EAAGC,GACnBtD,EAAME,cAAgB,GAEtBF,EAAME,cAAgBoD,CAE1B,CACAtD,EAAMjB,kBAAmB,CAC3B,CAoEA,SAAS0E,EAAWzD,GAClB,OAAQA,EAAM5B,QACN4B,EAAMR,aACW,IAAjBQ,EAAMrB,SACLqB,EAAMH,SACmB,IAA1BG,EAAMC,SAAStB,SACdqB,EAAM1B,WACN0B,EAAMpB,UACNoB,EAAMN,eACNM,EAAMD,YACjB,CAuDA,SAAS2D,EAAU/F,EAAQqC,GACpBA,EAAMP,aAAgBO,EAAM9B,cACF,mBAAlBP,EAAO0D,QAA0BrB,EAAMzB,WAIhDyB,EAAMP,aAAc,EACpB9B,EAAOuF,KAAK,eAJZlD,EAAM9B,aAAc,EAxD1B,SAAmBP,EAAQqC,GACzB,IAAI2D,GAAS,EAEb,SAASC,EAAS1B,GAChB,GAAIyB,EACFzG,EAAeS,EAAQuE,GAAOvF,UAMhC,GAHAgH,GAAS,EAET3D,EAAMT,YACF2C,EAAK,CACP,MAAMkB,EAAoBpD,EAAMzC,GAAa8F,OAAO,GACpD,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAkBzE,OAAQ2E,IAC5CF,EAAkBE,GAAGpB,GAEvBhF,EAAeS,EAAQuE,EAAKlC,EAAMlB,KACpC,MAAW2E,EAAWzD,KACpBA,EAAMP,aAAc,EACpB9B,EAAOuF,KAAK,aAIZlD,EAAMT,YACNhD,EAAQ4F,SAAS0B,EAAQlG,EAAQqC,GAErC,CAEAA,EAAMlB,MAAO,EACbkB,EAAMT,YAEN,IACE,MAAMuE,EAASnG,EAAO0D,OAAOuC,GAC7B,GAAc,MAAVE,EAAgB,CAClB,MAAMC,EAAOD,EAAOC,KACA,mBAATA,GACTA,EAAKnD,KACHkD,GACA,WACEvH,EAAQ4F,SAASyB,EAAU,KAC7B,IACA,SAAS1B,GACP3F,EAAQ4F,SAASyB,EAAU1B,EAC7B,GAEN,CAGF,CAFE,MAAOA,GACP0B,EAASjG,EACX,CAEAqC,EAAMlB,MAAO,CACf,CAMMkF,CAAUrG,EAAQqC,IAMxB,CAEA,SAAS0B,EAAY/D,EAAQqC,EAAOlB,GAC9B2E,EAAWzD,KACb0D,EAAU/F,EAAQqC,GACM,IAApBA,EAAMT,WAAmBkE,EAAWzD,KACtCA,EAAMT,YACFT,EACFvC,EAAQ4F,SAAS0B,EAAQlG,EAAQqC,GAEjC6D,EAAOlG,EAAQqC,IAIvB,CAEA,SAAS6D,EAAOlG,EAAQqC,GACtBA,EAAMT,YACNS,EAAM1B,UAAW,EAEjB,MAAM8E,EAAoBpD,EAAMzC,GAAa8F,OAAO,GACpD,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAkBzE,OAAQ2E,IAC5CF,EAAkBE,KAKpB,GAFA3F,EAAOuF,KAAK,UAERlD,EAAMJ,YAAa,CAGrB,MAAMqE,EAAStG,EAAOmF,iBACDmB,GACnBA,EAAOrE,cAGNqE,EAAOC,aAAkC,IAApBD,EAAOE,YAG7BxG,EAAOuD,SAEX,CACF,CAhfA9D,OAAOmD,eAAe/D,SAAUgB,OAAOmD,YAAa,CAClDyD,MAAO,SAASC,GACd,QAAI5D,EAAgBG,KAAK9C,KAAMuG,IAC3BvG,OAAStB,WAEN6H,GAAUA,EAAOxD,0BAA0BpD,cACpD,IAIFjB,SAASc,UAAUgH,KAAO,WACxBpH,EAAeY,KAAM,IAAIlB,EAC3B,EAoDAJ,SAASc,UAAUwD,MAAQ,SAASa,EAAOC,EAAUC,GACnD,OAA6C,IAAtCd,EAAOjD,KAAM6D,EAAOC,EAAUC,EACvC,EAEArF,SAASc,UAAUiH,KAAO,WACxBzG,KAAK+C,eAAehC,QACtB,EAEArC,SAASc,UAAUkH,OAAS,WAC1B,MAAMxE,EAAQlC,KAAK+C,eAEfb,EAAMnB,SACRmB,EAAMnB,SAEDmB,EAAMpB,SACT6C,EAAY3D,KAAMkC,GAExB,EAEAxD,SAASc,UAAUmH,mBAAqB,SAA4B7C,GAIlE,GAFwB,iBAAbA,IACTA,EAAWA,EAAS8C,gBACjBrI,EAAOyF,WAAWF,GACrB,MAAM,IAAI3E,EAAqB2E,GAEjC,OADA9D,KAAK+C,eAAenC,gBAAkBkD,EAC/B9D,IACT,EA+NAtB,SAASc,UAAUyD,OAAS,SAASY,EAAOC,EAAUC,GACpD,IAAI/D,KAAKmD,QAGP,MAAM,IAAIvE,EAA2B,YAFrCoB,KAAKmD,QAAQ,CAAC,CAAEU,QAAOC,aAAaC,EAIxC,EAEArF,SAASc,UAAU2D,QAAU,KAE7BzE,SAASc,UAAUqH,IAAM,SAAShD,EAAOC,EAAUC,GACjD,MAAM7B,EAAQlC,KAAK+C,eAWnB,IAAIqB,EAEJ,GAXqB,mBAAVP,GACTE,EAAKF,EACLA,EAAQ,KACRC,EAAW,MACkB,mBAAbA,IAChBC,EAAKD,EACLA,EAAW,MAKTD,QAAuC,CACzC,MAAMW,EAAMvB,EAAOjD,KAAM6D,EAAOC,GAC5BU,aAAesC,QACjB1C,EAAMI,EAEV,CAkCA,OA/BItC,EAAMnB,SACRmB,EAAMnB,OAAS,EACff,KAAK0G,UAGHtC,IAEQlC,EAAMH,SAAYG,EAAM5B,OAUzB4B,EAAM1B,SACf4D,EAAM,IAAIpF,EAA4B,OAC7BkD,EAAMzB,YACf2D,EAAM,IAAIrF,EAAqB,SAN/BmD,EAAM5B,QAAS,EACfsD,EAAY5D,KAAMkC,GAAO,GACzBA,EAAM3B,OAAQ,IAOE,mBAAPwD,IACLK,GAAOlC,EAAM1B,SACf/B,EAAQ4F,SAASN,EAAIK,GAErBlC,EAAMzC,GAAagF,KAAKV,IAIrB/D,IACT,EAwHAV,OAAOyH,iBAAiBrI,SAASc,UAAW,CAE1CiB,UAAW,CACTiC,MACE,QAAO1C,KAAK+C,gBAAiB/C,KAAK+C,eAAetC,SACnD,EACAuG,IAAIV,GAEEtG,KAAK+C,iBACP/C,KAAK+C,eAAetC,UAAY6F,EAEpC,GAGFW,SAAU,CACRvE,MACE,MAAMwE,EAAIlH,KAAK+C,eAKf,SAASmE,IAAoB,IAAfA,EAAED,UAAuBC,EAAEzG,WAAcyG,EAAEnF,SACtDmF,EAAE5G,QAAW4G,EAAE3G,MACpB,EACAyG,IAAIG,GAEEnH,KAAK+C,iBACP/C,KAAK+C,eAAekE,WAAaE,EAErC,GAGFC,iBAAkB,CAChB1E,MACE,QAAO1C,KAAK+C,gBAAiB/C,KAAK+C,eAAevC,QACnD,GAGFN,mBAAoB,CAClBwC,MACE,QAAO1C,KAAK+C,gBAAiB/C,KAAK+C,eAAe9C,UACnD,GAGFoH,eAAgB,CACd3E,MACE,OAAO1C,KAAK+C,gBAAkB/C,KAAK+C,eAAeR,WACpD,GAGF+E,cAAe,CACb5E,MACE,QAAO1C,KAAK+C,gBAAiB/C,KAAK+C,eAAezC,MACnD,GAGFiH,kBAAmB,CACjB7E,MACE,MAAM8E,EAASxH,KAAK+C,eACpB,QAAKyE,KACGA,EAAO/G,YAAc+G,EAAOlH,QAAUkH,EAAOnH,UACvD,GAGFoH,sBAAuB,CACrB/E,MACE,OAAO1C,KAAK+C,gBAAkB/C,KAAK+C,eAAe5C,aACpD,GAGFuH,eAAgB,CACdhF,MACE,OAAO1C,KAAK+C,eAAiB/C,KAAK+C,eAAehC,OAAS,CAC5D,GAGF4G,eAAgB,CACdjF,MACE,OAAO1C,KAAK+C,gBAAkB/C,KAAK+C,eAAelC,MACpD,KAIJ,MAAMuC,EAAUlF,EAAYkF,QAC5B1E,SAASc,UAAU4D,QAAU,SAASgB,EAAKL,GACzC,MAAM7B,EAAQlC,KAAK+C,eAUnB,OAPKb,EAAMzB,YACRyB,EAAME,cAAgBF,EAAMC,SAAStB,QACpCqB,EAAMzC,GAAaoB,SACrBpC,EAAQ4F,SAASS,EAAa5C,GAGhCkB,EAAQN,KAAK9C,KAAMoE,EAAKL,GACjB/D,IACT,EAEAtB,SAASc,UAAUoI,WAAa1J,EAAY2J,UAC5CnJ,SAASc,UAAU6D,SAAW,SAASe,EAAKL,GAC1CA,EAAGK,EACL,EAEA1F,SAASc,UAAUhB,EAAGsJ,wBAA0B,SAAS1D,GACvDpE,KAAKoD,QAAQgB,EACf"}
✄
import{addAbortSignal as t}from"./add-abort-signal.js";import*as e from"./destroy.js";import{codes as i}from"../errors.js";import{Stream as r}from"./legacy.js";import{getHighWaterMark as n,getDefaultHighWaterMark as o}from"./state.js";import{Buffer as s}from"buffer";import l from"events";import f from"process";export default Writable;const{ERR_INVALID_ARG_TYPE:c,ERR_METHOD_NOT_IMPLEMENTED:a,ERR_MULTIPLE_CALLBACK:d,ERR_STREAM_CANNOT_PIPE:u,ERR_STREAM_DESTROYED:h,ERR_STREAM_ALREADY_FINISHED:b,ERR_STREAM_NULL_VALUES:w,ERR_STREAM_WRITE_AFTER_END:p,ERR_UNKNOWN_ENCODING:g}=i,{errorOrDestroy:y}=e;function _(){}Object.setPrototypeOf(Writable.prototype,r.prototype),Object.setPrototypeOf(Writable,r);const S=Symbol("kOnFinished");export function WritableState(t,e,i){"boolean"!=typeof i&&(i=e instanceof r.Duplex),this.objectMode=!(!t||!t.objectMode),i&&(this.objectMode=this.objectMode||!(!t||!t.writableObjectMode)),this.highWaterMark=t?n(this,t,"writableHighWaterMark",i):o(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const s=!(!t||!1!==t.decodeStrings);this.decodeStrings=!s,this.defaultEncoding=t&&t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=R.bind(void 0,e),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,k(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!t||!1!==t.emitClose,this.autoDestroy=!t||!1!==t.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[S]=[]}function k(t){t.buffered=[],t.bufferedIndex=0,t.allBuffers=!0,t.allNoop=!0}WritableState.prototype.getBuffer=function(){return this.buffered.slice(this.bufferedIndex)},Object.defineProperty(WritableState.prototype,"bufferedRequestCount",{get(){return this.buffered.length-this.bufferedIndex}});const E=Function.prototype[Symbol.hasInstance];export function Writable(i){const n=this instanceof r.Duplex;if(!n&&!E.call(Writable,this))return new Writable(i);this._writableState=new WritableState(i,this,n),i&&("function"==typeof i.write&&(this._write=i.write),"function"==typeof i.writev&&(this._writev=i.writev),"function"==typeof i.destroy&&(this._destroy=i.destroy),"function"==typeof i.final&&(this._final=i.final),"function"==typeof i.construct&&(this._construct=i.construct),i.signal&&t(i.signal,this)),r.call(this,i),e.construct(this,(()=>{const t=this._writableState;t.writing||D(this,t),A(this,t)}))}function W(t,e,i,n){const o=t._writableState;if("function"==typeof i)n=i,i=o.defaultEncoding;else{if(i){if("buffer"!==i&&!s.isEncoding(i))throw new g(i)}else i=o.defaultEncoding;"function"!=typeof n&&(n=_)}if(null===e)throw new w;if(!o.objectMode)if("string"==typeof e)!1!==o.decodeStrings&&(e=s.from(e,i),i="buffer");else if(e instanceof s)i="buffer";else{if(!r._isUint8Array(e))throw new c("chunk",["string","Buffer","Uint8Array"],e);e=r._uint8ArrayToBuffer(e),i="buffer"}let l;return o.ending?l=new p:o.destroyed&&(l=new h("write")),l?(f.nextTick(n,l),y(t,l,!0),l):(o.pendingcb++,function(t,e,i,r,n){const o=e.objectMode?1:i.length;e.length+=o;const s=e.length<e.highWaterMark;s||(e.needDrain=!0);e.writing||e.corked||e.errored||!e.constructed?(e.buffered.push({chunk:i,encoding:r,callback:n}),e.allBuffers&&"buffer"!==r&&(e.allBuffers=!1),e.allNoop&&n!==_&&(e.allNoop=!1)):(e.writelen=o,e.writecb=n,e.writing=!0,e.sync=!0,t._write(i,r,e.onwrite),e.sync=!1);return s&&!e.errored&&!e.destroyed}(t,o,e,i,n))}function m(t,e,i,r,n,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new h("write")):i?t._writev(n,e.onwrite):t._write(n,o,e.onwrite),e.sync=!1}function T(t,e,i,r){--e.pendingcb,r(i),x(e),y(t,i)}function R(t,e){const i=t._writableState,r=i.sync,n=i.writecb;"function"==typeof n?(i.writing=!1,i.writecb=null,i.length-=i.writelen,i.writelen=0,e?(e.stack,i.errored||(i.errored=e),t._readableState&&!t._readableState.errored&&(t._readableState.errored=e),r?f.nextTick(T,t,i,e,n):T(t,i,e,n)):(i.buffered.length>i.bufferedIndex&&D(t,i),r?null!==i.afterWriteTickInfo&&i.afterWriteTickInfo.cb===n?i.afterWriteTickInfo.count++:(i.afterWriteTickInfo={count:1,cb:n,stream:t,state:i},f.nextTick(I,i.afterWriteTickInfo)):M(t,i,1,n))):y(t,new d)}function I({stream:t,state:e,count:i,cb:r}){return e.afterWriteTickInfo=null,M(t,e,i,r)}function M(t,e,i,r){for(!e.ending&&!t.destroyed&&0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"));i-- >0;)e.pendingcb--,r();e.destroyed&&x(e),A(t,e)}function x(t){if(t.writing)return;for(let e=t.bufferedIndex;e<t.buffered.length;++e){const{chunk:i,callback:r}=t.buffered[e],n=t.objectMode?1:i.length;t.length-=n,r(t.errored??new h("write"))}const e=t[S].splice(0);for(let i=0;i<e.length;i++)e[i](t.errored??new h("end"));k(t)}function D(t,e){if(e.corked||e.bufferProcessing||e.destroyed||!e.constructed)return;const{buffered:i,bufferedIndex:r,objectMode:n}=e,o=i.length-r;if(!o)return;let s=r;if(e.bufferProcessing=!0,o>1&&t._writev){e.pendingcb-=o-1;const r=e.allNoop?_:t=>{for(let e=s;e<i.length;++e)i[e].callback(t)},n=e.allNoop&&0===s?i:i.slice(s);n.allBuffers=e.allBuffers,m(t,e,!0,e.length,n,"",r),k(e)}else{do{const{chunk:r,encoding:o,callback:l}=i[s];i[s++]=null;m(t,e,!1,n?1:r.length,r,o,l)}while(s<i.length&&!e.writing);s===i.length?k(e):s>256?(i.splice(0,s),e.bufferedIndex=0):e.bufferedIndex=s}e.bufferProcessing=!1}function j(t){return t.ending&&t.constructed&&0===t.length&&!t.errored&&0===t.buffered.length&&!t.finished&&!t.writing&&!t.errorEmitted&&!t.closeEmitted}function N(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.finalCalled=!0,function(t,e){let i=!1;function r(r){if(i)y(t,r??d());else if(i=!0,e.pendingcb--,r){const i=e[S].splice(0);for(let t=0;t<i.length;t++)i[t](r);y(t,r,e.sync)}else j(e)&&(e.prefinished=!0,t.emit("prefinish"),e.pendingcb++,f.nextTick(O,t,e))}e.sync=!0,e.pendingcb++;try{const e=t._final(r);if(null!=e){const t=e.then;"function"==typeof t&&t.call(e,(function(){f.nextTick(r,null)}),(function(t){f.nextTick(r,t)}))}}catch(e){r(t)}e.sync=!1}(t,e)))}function A(t,e,i){j(e)&&(N(t,e),0===e.pendingcb&&j(e)&&(e.pendingcb++,i?f.nextTick(O,t,e):O(t,e)))}function O(t,e){e.pendingcb--,e.finished=!0;const i=e[S].splice(0);for(let t=0;t<i.length;t++)i[t]();if(t.emit("finish"),e.autoDestroy){const e=t._readableState;(!e||e.autoDestroy&&(e.endEmitted||!1===e.readable))&&t.destroy()}}Object.defineProperty(Writable,Symbol.hasInstance,{value:function(t){return!!E.call(this,t)||this===Writable&&(t&&t._writableState instanceof WritableState)}}),Writable.prototype.pipe=function(){y(this,new u)},Writable.prototype.write=function(t,e,i){return!0===W(this,t,e,i)},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){const t=this._writableState;t.corked&&(t.corked--,t.writing||D(this,t))},Writable.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!s.isEncoding(t))throw new g(t);return this._writableState.defaultEncoding=t,this},Writable.prototype._write=function(t,e,i){if(!this._writev)throw new a("_write()");this._writev([{chunk:t,encoding:e}],i)},Writable.prototype._writev=null,Writable.prototype.end=function(t,e,i){const r=this._writableState;let n;if("function"==typeof t?(i=t,t=null,e=null):"function"==typeof e&&(i=e,e=null),null!=t){const i=W(this,t,e);i instanceof Error&&(n=i)}return r.corked&&(r.corked=1,this.uncork()),n||(r.errored||r.ending?r.finished?n=new b("end"):r.destroyed&&(n=new h("end")):(r.ending=!0,A(this,r,!0),r.ended=!0)),"function"==typeof i&&(n||r.finished?f.nextTick(i,n):r[S].push(i)),this},Object.defineProperties(Writable.prototype,{destroyed:{get(){return!!this._writableState&&this._writableState.destroyed},set(t){this._writableState&&(this._writableState.destroyed=t)}},writable:{get(){const t=this._writableState;return!(!t||!1===t.writable||t.destroyed||t.errored||t.ending||t.ended)},set(t){this._writableState&&(this._writableState.writable=!!t)}},writableFinished:{get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{get(){const t=this._writableState;return!!t&&(!t.destroyed&&!t.ending&&t.needDrain)}},writableHighWaterMark:{get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{get(){return this._writableState?this._writableState.corked:0}},writableLength:{get(){return this._writableState&&this._writableState.length}}});const P=e.destroy;Writable.prototype.destroy=function(t,e){const i=this._writableState;return!i.destroyed&&(i.bufferedIndex<i.buffered.length||i[S].length)&&f.nextTick(x,i),P.call(this,t,e),this},Writable.prototype._undestroy=e.undestroy,Writable.prototype._destroy=function(t,e){e(t)},Writable.prototype[l.captureRejectionSymbol]=function(t){this.destroy(t)};
✄
{"version":3,"file":"readable.js","names":["addAbortSignal","compose","destroyer","Duplex","eos","LegacyStream","PassThrough","pipeline","promises","Readable","Transform","isDisturbed","Writable","Buffer","promisify","types","finished","destroy","Object","defineProperty","configurable","enumerable","get","custom","Stream","_isUint8Array","isUint8Array","_uint8ArrayToBuffer","from"],"sourceRoot":"/root/frida/build/subprojects/frida-tools/agents/fs/fs_agent.js.p/node_modules/@frida/readable-stream/","sources":[""],"mappings":"yBAASA,MAAsB,mCACxBC,MAAa,uCACXC,MAAiB,0BACnBC,MAAY,yBACZC,MAAS,0CACGC,MAAoB,yBAChCC,MAAiB,8BACjBC,MAAc,8BACTC,MAAc,2BACnBC,MAAc,2BACdC,MAAe,2CACbC,MAAmB,wBACrBC,MAAc,qCAEZC,MAAc,6BACdC,WAAWC,MAAa,sBAElBN,SAEbE,iBACAF,YACAJ,kBACAI,cACAG,cACAT,YACAO,eACAJ,iBACAC,cACAP,oBACAI,cACAF,aACAD,aACAO,eAGFH,EAAaM,YAAcA,EAC3BN,EAAaI,SAAWA,EACxBJ,EAAaO,SAAWA,EACxBP,EAAaF,OAASA,EACtBE,EAAaK,UAAYA,EACzBL,EAAaC,YAAcA,EAC3BD,EAAaE,SAAWA,EACxBF,EAAaL,eAAiBA,EAC9BK,EAAaW,SAAWZ,EACxBC,EAAaY,QAAUf,EACvBG,EAAaJ,QAAUA,EAEvBiB,OAAOC,eAAed,EAAc,WAAY,CAC9Ce,cAAc,EACdC,YAAY,EACZC,IAAG,IACMd,IAIXU,OAAOC,eAAeZ,EAAUO,EAAUS,OAAQ,CAChDF,YAAY,EACZC,IAAG,IACMd,EAASD,WAIpBW,OAAOC,eAAef,EAAKU,EAAUS,OAAQ,CAC3CF,YAAY,EACZC,IAAG,IACMd,EAASQ,WAKpBX,EAAamB,OAASnB,EAEtBA,EAAaoB,cAAgBV,EAAMW,aACnCrB,EAAasB,oBAAsBd,EAAOe"}
✄
import{addAbortSignal as r}from"./lib/add-abort-signal.js";import e from"./lib/compose.js";import{destroyer as i}from"./lib/destroy.js";import o from"./lib/duplex.js";import t from"./lib/end-of-stream.js";import{Stream as m}from"./lib/legacy.js";import s from"./lib/passthrough.js";import a from"./lib/pipeline.js";import*as p from"./lib/promises.js";import l from"./lib/readable.js";import f from"./lib/transform.js";import{isDisturbed as b}from"./lib/utils.js";import n from"./lib/writable.js";import{Buffer as d}from"buffer";import{promisify as u,types as j}from"util";export default l;export{b as isDisturbed,l as Stream,m as LegacyStream,l as Readable,n as Writable,o as Duplex,f as Transform,s as PassThrough,a as pipeline,r as addAbortSignal,t as finished,i as destroy,e as compose,p as promises};m.isDisturbed=b,m.Readable=l,m.Writable=n,m.Duplex=o,m.Transform=f,m.PassThrough=s,m.pipeline=a,m.addAbortSignal=r,m.finished=t,m.destroy=i,m.compose=e,Object.defineProperty(m,"promises",{configurable:!0,enumerable:!0,get:()=>p}),Object.defineProperty(a,u.custom,{enumerable:!0,get:()=>p.pipeline}),Object.defineProperty(t,u.custom,{enumerable:!0,get:()=>p.finished}),m.Stream=m,m._isUint8Array=j.isUint8Array,m._uint8ArrayToBuffer=d.from;
✄
{"version":3,"file":"index.js","names":["isDisturbed","LegacyStream","Readable","Writable","Duplex","Transform","PassThrough","pipeline","addAbortSignal","finished","destroy","compose","promises"],"sourceRoot":"/root/frida/build/subprojects/frida-tools/agents/fs/fs_agent.js.p/node_modules/@frida/stream/","sources":[""],"mappings":"sBACEA,kBACAC,cACAC,cACAC,YACAC,eACAC,iBACAC,cACAC,oBACAC,cACAC,aACAC,aACAC,cACAC,MACK,iCAEQX,SAEbD,iBACAC,YACAC,cACAC,cACAC,YACAC,eACAC,iBACAC,cACAC,oBACAC,cACAC,aACAC,aACAC"}
✄
import{isDisturbed as e,LegacyStream as r,Readable as a,Writable as t,Duplex as m,Transform as o,PassThrough as p,pipeline as d,addAbortSignal as f,finished as l,destroy as s,compose as x,promises as b}from"readable-stream";export default r;export{e as isDisturbed,r as Stream,a as Readable,t as Writable,m as Duplex,o as Transform,p as PassThrough,d as pipeline,f as addAbortSignal,l as finished,s as destroy,x as compose,b as promises};
✄
{"version":3,"file":"string_decoder.js","names":["Buffer","StringDecoder","isEncoding","encoding","nb","this","enc","nenc","retried","toLowerCase","_normalizeEncoding","undefined","Error","normalizeEncoding","text","utf16Text","end","utf16End","fillLast","utf8FillLast","base64Text","base64End","write","simpleWrite","simpleEnd","lastNeed","lastTotal","lastChar","allocUnsafe","utf8CheckByte","byte","buf","p","r","self","length","utf8CheckExtraBytes","copy","toString","i","c","charCodeAt","slice","n","prototype","total","j","utf8CheckIncomplete"],"sourceRoot":"/root/frida/build/subprojects/frida-tools/agents/fs/fs_agent.js.p/node_modules/@frida/string_decoder/lib/","sources":[""],"mappings":"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"}
✄
import{Buffer as t}from"buffer";export default{StringDecoder};const e=t.isEncoding;export function StringDecoder(s){let u;switch(this.encoding=function(s){const i=function(t){if(!t)return"utf8";let e=!1;for(;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(s);if(void 0===i&&(t.isEncoding===e||!e(s)))throw new Error("Unknown encoding: "+s);return i||s}(s),this.encoding){case"utf16le":this.text=n,this.end=r,u=4;break;case"utf8":this.fillLast=i,u=4;break;case"base64":this.text=l,this.end=a,u=3;break;default:return this.write=h,void(this.end=o)}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(u)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function i(t){const e=this.lastTotal-this.lastNeed,s=function(t,e,s){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==s?s:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function n(t,e){if((t.length-e)%2==0){const s=t.toString("utf16le",e);if(s){const e=s.charCodeAt(s.length-1);if(e>=55296&&e<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function r(t){const e=t&&t.length?this.write(t):"";if(this.lastNeed){const t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function l(t,e){const s=(t.length-e)%3;return 0===s?t.toString("base64",e):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-s))}function a(t){const e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function h(t){return t.toString(this.encoding)}function o(t){return t&&t.length?this.write(t):""}StringDecoder.prototype.write=function(t){if(0===t.length)return"";let e,s;if(this.lastNeed){if(e=this.fillLast(t),void 0===e)return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<t.length?e?e+this.text(t,s):this.text(t,s):e||""},StringDecoder.prototype.end=function(t){const e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},StringDecoder.prototype.text=function(t,e){const i=function(t,e,i){let n=e.length-1;if(n<i)return 0;let r=s(e[n]);if(r>=0)return r>0&&(t.lastNeed=r-1),r;if(--n<i||-2===r)return 0;if(r=s(e[n]),r>=0)return r>0&&(t.lastNeed=r-2),r;if(--n<i||-2===r)return 0;if(r=s(e[n]),r>=0)return r>0&&(2===r?r=0:t.lastNeed=r-3),r;return 0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=i;const n=t.length-(i-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)},StringDecoder.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};
✄
{"version":3,"file":"types.js","names":["ObjectToString","uncurryThis","Object","prototype","toString","numberValue","Number","valueOf","stringValue","String","booleanValue","Boolean","bigIntValue","BigInt","symbolValue","Symbol","generatorPrototype","getPrototypeOf","typedArrayPrototype","Int8Array","isArgumentsObject","value","toStringTag","isGeneratorFunction","isTypedArray","isPromise","input","Promise","isArrayBufferView","ArrayBuffer","isView","isUint8Array","Uint8Array","isUint8ClampedArray","Uint8ClampedArray","isUint16Array","Uint16Array","isUint32Array","Uint32Array","isInt8Array","isInt16Array","Int16Array","isInt32Array","Int32Array","isFloat32Array","Float32Array","isFloat64Array","Float64Array","isBigInt64Array","BigInt64Array","isBigUint64Array","BigUint64Array","isMap","isSet","isWeakMap","isWeakSet","isArrayBuffer","isDataView","isSharedArrayBuffer","isAsyncFunction","isMapIterator","isSetIterator","isGeneratorObject","isWebAssemblyCompiledModule","isNumberObject","checkBoxedPrimitive","isStringObject","isBooleanObject","isBigIntObject","isSymbolObject","prototypeValueOf","e","isBoxedPrimitive","isAnyArrayBuffer","isProxy","throwNotSupported","isExternal","isModuleNamespaceObject","method","Error","f","call","bind"],"sourceRoot":"/root/frida/build/subprojects/frida-tools/agents/fs/fs_agent.js.p/node_modules/@frida/util/support/","sources":[""],"mappings":"AAGA,MAAMA,EAAiBC,EAAYC,OAAOC,UAAUC,UAE9CC,EAAcJ,EAAYK,OAAOH,UAAUI,SAC3CC,EAAcP,EAAYQ,OAAON,UAAUI,SAC3CG,EAAeT,EAAYU,QAAQR,UAAUI,SAE7CK,EAAcX,EAAYY,OAAOV,UAAUI,SAE3CO,EAAcb,EAAYc,OAAOZ,UAAUI,SAE3CS,EAAqBd,OAAOe,gBAAe,YAAc,IACzDC,EAAsBhB,OAAOe,eAAeE,kBAE3C,SAASC,kBAAkBC,GAChC,OAAc,OAAVA,GAAmC,iBAAVA,KAAsBN,OAAOO,eAAeD,KAGxC,uBAA1BrB,EAAeqB,EACxB,QAEO,SAASE,oBAAoBF,GAClC,OAAOnB,OAAOe,eAAeI,KAAWL,CAC1C,QAEO,SAASQ,aAAaH,GAC3B,OAAOA,aAAiBH,CAC1B,QAEO,SAASO,UAAUC,GACxB,OAAOA,aAAiBC,OAC1B,QAEO,SAASC,kBAAkBP,GAChC,OAAOQ,YAAYC,OAAOT,EAC5B,QAEO,SAASU,aAAaV,GAC3B,OAAOA,aAAiBW,UAC1B,QAEO,SAASC,oBAAoBZ,GAClC,OAAOA,aAAiBa,iBAC1B,QAEO,SAASC,cAAcd,GAC5B,OAAOA,aAAiBe,WAC1B,QAEO,SAASC,cAAchB,GAC5B,OAAOA,aAAiBiB,WAC1B,QAEO,SAASC,YAAYlB,GAC1B,OAAOA,aAAiBF,SAC1B,QAEO,SAASqB,aAAanB,GAC3B,OAAOA,aAAiBoB
"""


```