Response:
The user has provided a code snippet from `gumquickcore.c` which is a part of Frida. They want to understand its functionality, how it relates to reverse engineering, its connection to low-level concepts, any logical inferences, potential user errors, and how a user might end up at this code. This is part 2 of a 6-part analysis, and the user wants a summary of the functionality.

The code primarily defines accessors for CPU registers within the Frida environment. These accessors allow JavaScript code running within Frida to read and manipulate the CPU state of a target process. This is a core function for dynamic instrumentation and reverse engineering.

Here's a plan to address each of the user's requests:

1. **Functionality:** Describe what the code does at a high level.
2. **Relationship to Reverse Engineering:**  Explain how accessing CPU registers is crucial for reverse engineering tasks. Provide examples.
3. **Binary/Low-Level/Kernel/Framework Knowledge:** Highlight the underlying concepts this code interacts with (CPU registers, instruction pointers, etc.). Mention Linux/Android relevance if applicable.
4. **Logical Inference:** Look for any implicit logic or conditions within the code.
5. **User Errors:** Consider common mistakes a user might make when interacting with these features in Frida.
6. **User Path:** Describe the steps a user would take to trigger the execution of this code.
7. **Summary of Functionality (Part 2):**  Provide a concise overview of this specific code snippet.```c
NTEXT_ACCESSOR_GPR_ALIASED (x26, x[26])
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR_ALIASED (x27, x[27])
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR_ALIASED (x28, x[28])

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (fp)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (lr)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q0, v[0].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q1, v[1].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q2, v[2].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q3, v[3].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q4, v[4].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q5, v[5].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q6, v[6].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q7, v[7].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q8, v[8].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q9, v[9].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q10, v[10].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q11, v[11].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q12, v[12].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q13, v[13].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q14, v[14].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q15, v[15].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q16, v[16].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q17, v[17].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q18, v[18].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q19, v[19].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q20, v[20].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q21, v[21].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q22, v[22].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q23, v[23].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q24, v[24].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q25, v[25].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q26, v[26].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q27, v[27].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q28, v[28].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q29, v[29].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q30, v[30].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q31, v[31].q)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d0, v[0].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d1, v[1].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d2, v[2].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d3, v[3].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d4, v[4].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d5, v[5].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d6, v[6].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d7, v[7].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d8, v[8].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d9, v[9].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d10, v[10].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d11, v[11].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d12, v[12].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d13, v[13].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d14, v[14].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d15, v[15].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d16, v[16].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d17, v[17].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d18, v[18].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d19, v[19].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d20, v[20].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d21, v[21].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d22, v[22].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d23, v[23].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d24, v[24].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d25, v[25].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d26, v[26].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d27, v[27].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d28, v[28].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d29, v[29].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d30, v[30].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d31, v[31].d)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s0, v[0].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s1, v[1].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s2, v[2].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s3, v[3].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s4, v[4].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s5, v[5].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s6, v[6].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s7, v[7].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s8, v[8].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s9, v[9].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s10, v[10].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s11, v[11].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s12, v[12].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s13, v[13].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s14, v[14].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s15, v[15].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s16, v[16].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s17, v[17].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s18, v[18].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s19, v[19].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s20, v[20].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s21, v[21].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s22, v[22].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s23, v[23].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s24, v[24].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s25, v[25].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s26, v[26].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s27, v[27].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s28, v[28].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s29, v[29].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s30, v[30].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s31, v[31].s)
#elif defined (HAVE_MIPS)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (pc)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (gp)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (sp)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (fp)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (ra)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (hi)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (lo)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (at)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (v0)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (v1)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (a0)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (a1)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (a2)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (a3)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t0)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t1)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t2)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t3)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t4)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t5)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t6)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t7)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t8)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t9)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s0)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s1)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s2)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s3)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s4)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s5)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s6)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s7)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (k0)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (k1)
#endif

static const JSCFunctionListEntry gumjs_cpu_context_entries[] =
{
#if defined (HAVE_I386) && GLIB_SIZEOF_VOID_P == 4
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR_ALIASED (pc, eip),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR_ALIASED (sp, esp),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (eax),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (ecx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (edx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (ebx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (esp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (ebp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (esi),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (edi),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (eip),
#elif defined (HAVE_I386) && GLIB_SIZEOF_VOID_P == 8
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR_ALIASED (pc, rip),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR_ALIASED (sp, rsp),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rax),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rcx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rdx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rbx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rsp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rbp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rsi),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rdi),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r15),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rip),
#elif defined (HAVE_ARM)
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (pc),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (sp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (cpsr),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r7),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r12),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (lr),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q15),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d28),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d29),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d30),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d31),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s28),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s29),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s30),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s31),
#elif defined (HAVE_ARM64)
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (pc),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (sp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (nzcv),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x28),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (fp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (lr),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q28),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q29),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q30),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q31),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d28),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d29),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d30),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d31),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s28),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s29),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s30),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s31),
#elif defined (HAVE_MIPS)
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (pc),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (gp),
  GUM_EXPORT_CPU
### 提示词
```
这是目录为frida/subprojects/frida-gum/bindings/gumjs/gumquickcore.c的fridaDynamic instrumentation tool的源代码文件， 请列举一下它的功能, 
如果它与逆向的方法有关系，请做出对应的举例说明，
如果涉及到二进制底层，linux, android内核及框架的知识，请做出对应的举例说明，
如果做了逻辑推理，请给出假设输入与输出,
如果涉及用户或者编程常见的使用错误，请举例说明,
说明用户操作是如何一步步的到达这里，作为调试线索。
这是第2部分，共6部分，请归纳一下它的功能
```

### 源代码
```c
NTEXT_ACCESSOR_GPR_ALIASED (x26, x[26])
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR_ALIASED (x27, x[27])
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR_ALIASED (x28, x[28])

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (fp)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (lr)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q0, v[0].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q1, v[1].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q2, v[2].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q3, v[3].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q4, v[4].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q5, v[5].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q6, v[6].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q7, v[7].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q8, v[8].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q9, v[9].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q10, v[10].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q11, v[11].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q12, v[12].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q13, v[13].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q14, v[14].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q15, v[15].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q16, v[16].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q17, v[17].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q18, v[18].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q19, v[19].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q20, v[20].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q21, v[21].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q22, v[22].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q23, v[23].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q24, v[24].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q25, v[25].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q26, v[26].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q27, v[27].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q28, v[28].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q29, v[29].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q30, v[30].q)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_VECTOR (q31, v[31].q)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d0, v[0].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d1, v[1].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d2, v[2].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d3, v[3].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d4, v[4].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d5, v[5].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d6, v[6].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d7, v[7].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d8, v[8].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d9, v[9].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d10, v[10].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d11, v[11].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d12, v[12].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d13, v[13].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d14, v[14].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d15, v[15].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d16, v[16].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d17, v[17].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d18, v[18].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d19, v[19].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d20, v[20].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d21, v[21].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d22, v[22].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d23, v[23].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d24, v[24].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d25, v[25].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d26, v[26].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d27, v[27].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d28, v[28].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d29, v[29].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d30, v[30].d)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_DOUBLE (d31, v[31].d)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s0, v[0].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s1, v[1].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s2, v[2].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s3, v[3].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s4, v[4].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s5, v[5].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s6, v[6].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s7, v[7].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s8, v[8].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s9, v[9].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s10, v[10].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s11, v[11].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s12, v[12].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s13, v[13].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s14, v[14].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s15, v[15].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s16, v[16].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s17, v[17].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s18, v[18].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s19, v[19].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s20, v[20].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s21, v[21].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s22, v[22].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s23, v[23].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s24, v[24].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s25, v[25].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s26, v[26].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s27, v[27].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s28, v[28].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s29, v[29].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s30, v[30].s)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_FLOAT (s31, v[31].s)
#elif defined (HAVE_MIPS)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (pc)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (gp)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (sp)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (fp)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (ra)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (hi)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (lo)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (at)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (v0)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (v1)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (a0)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (a1)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (a2)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (a3)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t0)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t1)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t2)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t3)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t4)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t5)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t6)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t7)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t8)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (t9)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s0)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s1)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s2)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s3)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s4)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s5)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s6)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (s7)

GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (k0)
GUM_DEFINE_CPU_CONTEXT_ACCESSOR_GPR (k1)
#endif

static const JSCFunctionListEntry gumjs_cpu_context_entries[] =
{
#if defined (HAVE_I386) && GLIB_SIZEOF_VOID_P == 4
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR_ALIASED (pc, eip),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR_ALIASED (sp, esp),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (eax),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (ecx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (edx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (ebx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (esp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (ebp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (esi),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (edi),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (eip),
#elif defined (HAVE_I386) && GLIB_SIZEOF_VOID_P == 8
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR_ALIASED (pc, rip),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR_ALIASED (sp, rsp),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rax),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rcx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rdx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rbx),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rsp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rbp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rsi),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rdi),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r15),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (rip),
#elif defined (HAVE_ARM)
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (pc),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (sp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (cpsr),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r7),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (r12),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (lr),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q15),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d28),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d29),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d30),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d31),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s28),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s29),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s30),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s31),
#elif defined (HAVE_ARM64)
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (pc),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (sp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (nzcv),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (x28),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (fp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (lr),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q28),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q29),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q30),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (q31),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d28),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d29),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d30),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (d31),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s9),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s10),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s11),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s12),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s13),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s14),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s15),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s16),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s17),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s18),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s19),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s20),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s21),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s22),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s23),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s24),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s25),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s26),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s27),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s28),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s29),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s30),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s31),
#elif defined (HAVE_MIPS)
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (pc),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (gp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (sp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (fp),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (ra),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (hi),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (lo),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (at),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (v0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (v1),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (a0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (a1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (a2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (a3),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (t0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (t1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (t2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (t3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (t4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (t5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (t6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (t7),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (t8),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (t9),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s1),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s2),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s3),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s4),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s5),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s6),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (s7),

  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (k0),
  GUM_EXPORT_CPU_CONTEXT_ACCESSOR (k1),
#endif

  JS_CFUNC_DEF ("toJSON", 0, gumjs_cpu_context_to_json),
};

static const JSClassDef gumjs_match_pattern_def =
{
  .class_name = "MatchPattern",
  .finalizer = gumjs_match_pattern_finalize,
};

static const JSClassDef gumjs_source_map_def =
{
  .class_name = "SourceMap",
  .finalizer = gumjs_source_map_finalize,
};

static const JSCFunctionListEntry gumjs_source_map_entries[] =
{
  JS_CFUNC_DEF ("_resolve", 0, gumjs_source_map_resolve),
};

static const JSClassDef gumjs_worker_def =
{
  .class_name = "_Worker",
};

static const JSCFunctionListEntry gumjs_worker_entries[] =
{
  JS_CFUNC_DEF ("terminate", 0, gumjs_worker_terminate),
  JS_CFUNC_DEF ("post", 0, gumjs_worker_post),
};

void
_gum_quick_core_init (GumQuickCore * self,
                      GumQuickScript * script,
                      JSContext * ctx,
                      JSValue ns,
                      GRecMutex * mutex,
                      GumESProgram * program,
                      const gchar * runtime_source_map,
                      GumQuickInterceptor * interceptor,
                      GumQuickStalker * stalker,
                      GumQuickMessageEmitter message_emitter,
                      gpointer message_emitter_data,
                      GumScriptScheduler * scheduler)
{
  JSRuntime * rt;
  JSValue global_obj, obj, proto, ctor, uint64_proto;

  rt = JS_GetRuntime (ctx);

  global_obj = JS_GetGlobalObject (ctx);

  g_object_get (script, "backend", &self->backend, NULL);
  g_object_unref (self->backend);

  self->script = script;
  self->program = program;
  self->runtime_source_map = runtime_source_map;
  self->interceptor = interceptor;
  self->stalker = stalker;
  self->message_emitter = message_emitter;
  self->message_emitter_data = message_emitter_data;
  self->scheduler = scheduler;
  self->exceptor = gum_exceptor_obtain ();
  self->rt = rt;
  self->ctx = ctx;
  self->module_data =
      g_hash_table_new_full (g_str_hash, g_str_equal, g_free, NULL);
  self->current_scope = NULL;
  self->current_owner = GUM_THREAD_ID_INVALID;

  gum_quick_core_setup_atoms (self);

  self->mutex = mutex;
  self->usage_count = 0;
  self->mutex_depth = 0;
  self->flush_notify = NULL;
  self->flush_data = NULL;
  self->flush_data_destroy = NULL;

  self->event_loop = g_main_loop_new (
      gum_script_scheduler_get_js_context (scheduler), FALSE);
  g_mutex_init (&self->event_mutex);
  g_cond_init (&self->event_cond);
  self->event_count = 0;
  self->event_source_available = TRUE;

  self->on_global_get = JS_NULL;
  self->global_receiver = JS_NULL;

  self->weak_callbacks = g_hash_table_new (NULL, NULL);
  self->next_weak_callback_id = 1;
  ctor = JS_GetPropertyStr (ctx, global_obj, "WeakMap");
  proto = JS_GetProperty (ctx, ctor, GUM_QUICK_CORE_ATOM (self, prototype));
  self->weak_objects = JS_CallConstructor (ctx, ctor, 0, NULL);
  self->weak_map_ctor = ctor;
  self->weak_map_get_method = JS_GetPropertyStr (ctx, proto, "get");
  self->weak_map_set_method = JS_GetPropertyStr (ctx, proto, "set");
  self->weak_map_delete_method = JS_GetPropertyStr (ctx, proto, "delete");
  JS_FreeValue (ctx, proto);

  self->scheduled_callbacks = g_hash_table_new (NULL, NULL);
  self->next_callback_id = 1;

  self->workers = g_hash_table_new_full (NULL, NULL, NULL,
      (GDestroyNotify) gum_quick_worker_destroy);

  self->subclasses = g_hash_table_new (NULL, NULL);

  JS_SetPropertyFunctionList (ctx, ns, gumjs_root_entries,
      G_N_ELEMENTS (gumjs_root_entries));

  obj = JS_NewObject (ctx);
  JS_SetPropertyFunctionList (ctx, obj, gumjs_frida_entries,
      G_N_ELEMENTS (gumjs_frida_entries));
  JS_DefinePropertyValueStr (ctx, ns, "Frida", obj, JS_PROP_C_W_E);

  obj = JS_NewObject (ctx);
  JS_SetPropertyFunctionList (ctx, obj, gumjs_script_entries,
      G_N_ELEMENTS (gumjs_script_entries));
  JS_DefinePropertyValueStr (ctx, ns, "Script", obj, JS_PROP_C_W_E);

  _gum_quick_create_class (ctx, &gumjs_weak_ref_def, self,
      &self->weak_ref_class, &proto);

  _gum_quick_create_class (ctx, &gumjs_int64_def, self, &self->int64_class,
      &proto);
  ctor = JS_NewCFunction2 (ctx, gumjs_int64_construct,
      gumjs_int64_def.class_name, 0, JS_CFUNC_constructor, 0);
  JS_SetConstructor (ctx, ctor, proto);
  JS_SetPropertyFunctionList (ctx, proto, gumjs_int64_entries,
      G_N_ELEMENTS (gumjs_int64_entries));
  JS_DefinePropertyValueStr (ctx, ns, gumjs_int64_def.class_name, ctor,
      JS_PROP_C_W_E);

  _gum_quick_create_class (ctx, &gumjs_uint64_def, self, &self->uint64_class,
      &proto);
  uint64_proto = proto;
  ctor = JS_NewCFunction2 (ctx, gumjs_uint64_construct,
      gumjs_uint64_def.class_name, 0, JS_CFUNC_constructor, 0);
  JS_SetConstructor (ctx, ctor, proto);
  JS_SetPropertyFunctionList (ctx, proto, gumjs_uint64_entries,
      G_N_ELEMENTS (gumjs_uint64_entries));
  JS_DefinePropertyValueStr (ctx, ns, gumjs_uint64_def.class_name, ctor,
      JS_PROP_C_W_E);

  _gum_quick_create_class (ctx, &gumjs_native_pointer_def, self,
      &self->native_pointer_class, &proto);
  self->native_pointer_proto = JS_DupValue (ctx, proto);
  ctor = JS_NewCFunction2 (ctx, gumjs_native_pointer_construct,
      gumjs_native_pointer_def.class_name, 0, JS_CFUNC_constructor, 0);
  JS_SetConstructor (ctx, ctor, proto);
  JS_SetPropertyFunctionList (ctx, proto, gumjs_native_pointer_entries,
      G_N_ELEMENTS (gumjs_native_pointer_entries));
  JS_DefinePropertyValueStr (ctx, ns, gumjs_native_pointer_def.class_name, ctor,
      JS_PROP_C_W_E);

  obj = JS_GetPropertyStr (ctx, global_obj, "ArrayBuffer");
  JS_SetPropertyFunctionList (ctx, obj, gumjs_array_buffer_class_entries,
      G_N_ELEMENTS (gumjs_array_buffer_class_entries));
  proto = JS_GetProperty (ctx, obj, GUM_QUICK_CORE_ATOM (self, prototype));
  JS_SetPropertyFunctionList (ctx, proto, gumjs_array_buffer_instance_entries,
      G_N_ELEMENTS (gumjs_array_buffer_instance_entries));
  JS_FreeValue (ctx, proto);
  JS_FreeValue (ctx, obj);

  _gum_quick_create_subclass (ctx, &gumjs_native_resource_def,
      self->native_pointer_class, self->native_pointer_proto, self,
      &self->native_resource_class, &proto);

  _gum_quick_create_subclass (ctx, &gumjs_kernel_resource_def,
      self->uint64_class, uint64_proto, self, &self->kernel_resource_class,
      &proto);

  _gum_quick_create_subclass (ctx, &gumjs_native_function_def,
      self->native_pointer_class, self->native_pointer_proto, self,
      &self->native_function_class, &proto);
  ctor = JS_NewCFunction2 (ctx, gumjs_native_function_construct,
      gumjs_native_function_def.class_name, 0, JS_CFUNC_constructor, 0);
  JS_SetConstructor (ctx, ctor, proto);
  JS_SetPropertyFunctionList (ctx, proto, gumjs_native_function_entries,
      G_N_ELEMENTS (gumjs_native_function_entries));
  JS_DefinePropertyValueStr (ctx, ns, gumjs_native_function_def.class_name,
      ctor, JS_PROP_C_W_E);

  _gum_quick_create_subclass (ctx, &gumjs_system_function_def,
      self->native_pointer_class, self->native_pointer_proto, self,
      &self->system_function_class, &proto);
  ctor = JS_NewCFunction2 (ctx, gumjs_system_function_construct,
      gumjs_system_function_def.class_name, 0, JS_CFUNC_constructor, 0);
  JS_SetConstructor (ctx, ctor, proto);
  JS_SetPropertyFunctionList (ctx, proto, gumjs_system_function_entries,
      G_N_ELEMENTS (gumjs_system_function_entries));
  JS_DefinePropertyValueStr (ctx, ns, gumjs_system_function_def.class_name,
      ctor, JS_PROP_C_W_E);

  _gum_quick_create_subclass (ctx, &gumjs_native_callback_def,
      self->native_pointer_class, self->native_pointer_proto, self,
      &self->native_callback_class, &proto);
  ctor = JS_NewCFunction2 (ctx, gumjs_native_callback_construct,
      gumjs_native_callback_def.class_name, 0, JS_CFUNC_constructor, 0);
  JS_SetConstructor (ctx, ctor, proto);
  JS_DefinePropertyValueStr (ctx, ns, gumjs_native_callback_def.class_name,
      ctor, JS_PROP_C_W_E);

  _gum_quick_create_class (ctx, &gumjs_callback_context_def, self,
      &self->callback_context_class, &proto);
  JS_SetPropertyFunctionList (ctx, proto, gumjs_callback_context_entries,
      G_N_ELEMENTS (gumjs_callback_context_entries));

  _gum_quick_create_class (ctx, &gumjs_cpu_context_def, self,
      &self->cpu_context_class, &proto);
  JS_SetPropertyFunctionList (ctx, proto, gumjs_cpu_context_entries,
      G_N_ELEMENTS (gumjs_cpu_context_entries));

  _gum_quick_create_class (ctx, &gumjs_match_pattern_def, self,
      &self->match_pattern_class, &proto);
  ctor = JS_NewCFunction2 (ctx, gumjs_match_pattern_construct,
      gumjs_match_pattern_def.class_name, 0, JS_CFUNC_constructor, 0);
  JS_SetConstructor (ctx, ctor, proto);
  JS_DefinePropertyValueStr (ctx, ns, gumjs_match_pattern_def.class_name, ctor,
      JS_PROP_C_W_E);

  _gum_quick_create_class (ctx, &gumjs_source_map_def, self,
      &self->source_map_class, &proto);
  ctor = JS_NewCFunction2 (ctx, gumjs_source_map_construct,
      gumjs_source_map_def.class_name, 0, JS_CFUNC_constructor, 0);
  self->source_map_ctor = JS_DupValue (ctx, ctor);
  JS_SetConstructor (ctx, ctor, proto);
  JS_SetPropertyFunctionList (ctx, proto, gumjs_source_map_entries,
      G_N_ELEMENTS (gumjs_source_map_entries));
  JS_DefinePropertyValueStr (ctx, ns, gumjs_source_map_def.class_name, ctor,
      JS_PROP_C_W_E);

  _gum_quick_create_class (ctx, &gumjs_worker_def, self, &self->worker_class,
      &proto);
  ctor = JS_NewCFunction2 (ctx, gumjs_worker_construct,
      gumjs_worker_def.class_name, 0, JS_CFUNC_constructor, 0);
  JS_SetConstructor (ctx, ctor, proto);
  JS_SetPropertyFunctionList (ctx, proto, gumjs_worker_entries,
      G_N_ELEMENTS (gumjs_worker_entries));
  JS_DefinePropertyValueStr (ctx, ns, gumjs_worker_def.class_name, ctor,
      JS_PROP_C_W_E);

  JS_FreeValue (ctx, global_obj);

  gum_exceptor_add (self->exceptor, gum_quick_core_handle_crashed_js, self);
}

static gboolean
gum_quick_core_handle_crashed_js (GumExceptionDetails * details,
                                  gpointer user_data)
{
  GumQuickCore * self = user_data;
  GumThreadId thread_id = details->thread_id;

  if (gum_exceptor_has_scope (self->exceptor, thread_id))
    return FALSE;

  if (self->current_owner == thread_id)
  {
    gum_interceptor_end_transaction (self->interceptor->interceptor);
    gum_quick_script_backend_mark_scope_mutex_trapped (self->backend);
  }

  return FALSE;
}

gboolean
_gum_quick_core_flush (GumQuickCore * self,
                       GumQuickFlushNotify flush_notify,
                       gpointer flush_data,
                       GDestroyNotify flush_data_destroy)
{
  JSContext * ctx = self->ctx;
  GHashTableIter iter;
  GumQuickScheduledCallback * callback;
  JSValue old_objects;
  gboolean done;

  self->flush_notify = flush_notify;
  self->flush_data = flush_data;
  self->flush_data_destroy = flush_data_destroy;

  g_mutex_lock (&self->event_mutex);
  self->event_source_available = FALSE;
  g_cond_broadcast (&self->event_cond);
  g_mutex_unlock (&self->event_mutex);
  g_main_loop_quit (self->event_loop);

  if (self->usage_count > 1)
    return FALSE;

  g_hash_table_iter_init (&iter, self->scheduled_callbacks);
  while (g_hash_table_iter_next (&iter, NULL, (gpointer *) &callback))
  {
    _gum_quick_core_pin (self);
    g_source_destroy (callback->source);
  }
  g_hash_table_remove_all (self->scheduled_callbacks);

  if (self->usage_count > 1)
    return FALSE;

  old_objects = self->weak_objects;
  self->weak_objects = JS_CallConstructor (ctx, self->weak_map_ctor, 0, NULL);
  JS_FreeValue (ctx, old_objects);

  done = self->usage_count == 1;
  if (done)
  {
    if (flush_data_destroy != NULL)
      flush_data_destroy (flush_data);

    self->flush_notify = NULL;
    self->flush_data = NULL;
    self->flush_data_destroy = NULL;
  }

  return done;
}

static void
gum_quick_core_notify_flushed (GumQuickCore * self,
                               GumQuickFlushNotify func,
                               gpointer data,
                               GDestroyNotify data_destroy)
{
  GumQuickFlushCallback * cb;
  GSource * source;

  cb = g_slice_new (GumQuickFlushCallback);
  cb->func = func;
  cb->data = data;
  cb->data_destroy = data_destroy;

  source = g_idle_source_new ();
  g_source_set_callback (source, (GSourceFunc) gum_quick_flush_callback_notify,
      cb, (GDestroyNotify) gum_quick_flush_callback_free);
  g_source_attach (source,
      gum_script_scheduler_get_js_context (self->scheduler));
  g_source_unref (source);
}

static void
gum_quick_flush_callback_free (GumQuickFlushCallback * self)
{
  if (self->data_destroy != NULL)
    self->data_destroy (self->data);

  g_slice_free (GumQuickFlushCallback, self);
}

static gboolean
gum_quick_flush_callback_notify (GumQuickFlushCallback * self)
{
  self->func (self->data);
  return FALSE;
}

void
_gum_quick_core_dispose (GumQuickCore * self)
{
  JSContext * ctx = self->ctx;

  g_hash_table_remove_all (self->workers);

  g_assert (g_hash_table_size (self->weak_callbacks) == 0);

  JS_SetGlobalAccessFunctions (ctx, NULL);

  JS_FreeValue (ctx, self->on_global_get);
  JS_FreeValue (ctx, self->global_receiver);
  self->on_global_get = JS_NULL;
  self->global_receiver = JS_NULL;

  g_clear_pointer (&self->unhandled_exception_sink,
      gum_quick_exception_sink_free);

  g_clear_pointer (&self->incoming_message_sink, gum_quick_message_sink_free);

  gum_exceptor_remove (self->exceptor, gum_quick_core_handle_crashed_js, self);
  g_object_unref (self->exceptor);
  self->exceptor = NULL;

  JS_FreeValue (ctx, self->source_map_ctor);
  JS_FreeValue (ctx, self->native_pointer_proto);

  JS_FreeValue (ctx, self->weak_objects);
  JS_FreeValue (ctx, self->weak_map_ctor);
  JS_FreeValue (ctx, self->weak_map_get_method);
  JS_FreeValue (ctx, self->weak_map_set_method);
  JS_FreeValue (ctx, self->weak_map_delete_method);
  self->weak_objects
```